<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Wed Jun 10 23:54:07 EDT 2015 -->
<title>Balancer</title>
<meta name="date" content="2015-06-10">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Balancer";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Balancer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Cli.html" title="class in org.apache.hadoop.hdfs.server.balancer"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hdfs/server/balancer/Balancer.html" target="_top">Frames</a></li>
<li><a href="Balancer.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.hadoop.hdfs.server.balancer</div>
<h2 title="Class Balancer" class="title">Class Balancer</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.hadoop.hdfs.server.balancer.Balancer</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>@InterfaceAudience.Private
public class <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.166">Balancer</a>
extends <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block"><p>The balancer is a tool that balances disk space usage on an HDFS cluster
 when some datanodes become full or when new empty nodes join the cluster.
 The tool is deployed as an application program that can be run by the 
 cluster administrator on a live HDFS cluster while applications
 adding and deleting files.
 
 <p>SYNOPSIS
 <pre>
 To start:
      bin/start-balancer.sh [-threshold <threshold>]
      Example: bin/ start-balancer.sh 
                     start the balancer with a default threshold of 10%
               bin/ start-balancer.sh -threshold 5
                     start the balancer with a threshold of 5%
               bin/ start-balancer.sh -idleiterations 20
                     start the balancer with maximum 20 consecutive idle iterations
               bin/ start-balancer.sh -idleiterations -1
                     run the balancer with default threshold infinitely
 To stop:
      bin/ stop-balancer.sh
 </pre>
 
 <p>DESCRIPTION
 <p>The threshold parameter is a fraction in the range of (1%, 100%) with a 
 default value of 10%. The threshold sets a target for whether the cluster 
 is balanced. A cluster is balanced if for each datanode, the utilization 
 of the node (ratio of used space at the node to total capacity of the node) 
 differs from the utilization of the (ratio of used space in the cluster 
 to total capacity of the cluster) by no more than the threshold value. 
 The smaller the threshold, the more balanced a cluster will become. 
 It takes more time to run the balancer for small threshold values. 
 Also for a very small threshold the cluster may not be able to reach the 
 balanced state when applications write and delete files concurrently.
 
 <p>The tool moves blocks from highly utilized datanodes to poorly 
 utilized datanodes iteratively. In each iteration a datanode moves or 
 receives no more than the lesser of 10G bytes or the threshold fraction 
 of its capacity. Each iteration runs no more than 20 minutes.
 At the end of each iteration, the balancer obtains updated datanodes
 information from the namenode.
 
 <p>A system property that limits the balancer's use of bandwidth is 
 defined in the default configuration file:
 <pre>
 <property>
   <name>dfs.balance.bandwidthPerSec</name>
   <value>1048576</value>
 <description>  Specifies the maximum bandwidth that each datanode 
 can utilize for the balancing purpose in term of the number of bytes 
 per second. </description>
 </property>
 </pre>
 
 <p>This property determines the maximum speed at which a block will be 
 moved from one datanode to another. The default value is 1MB/s. The higher 
 the bandwidth, the faster a cluster can reach the balanced state, 
 but with greater competition with application processes. If an 
 administrator changes the value of this property in the configuration 
 file, the change is observed when HDFS is next restarted.
 
 <p>MONITERING BALANCER PROGRESS
 <p>After the balancer is started, an output file name where the balancer 
 progress will be recorded is printed on the screen.  The administrator 
 can monitor the running of the balancer by reading the output file. 
 The output shows the balancer's status iteration by iteration. In each 
 iteration it prints the starting time, the iteration number, the total 
 number of bytes that have been moved in the previous iterations, 
 the total number of bytes that are left to move in order for the cluster 
 to be balanced, and the number of bytes that are being moved in this 
 iteration. Normally "Bytes Already Moved" is increasing while "Bytes Left 
 To Move" is decreasing.
 
 <p>Running multiple instances of the balancer in an HDFS cluster is 
 prohibited by the tool.
 
 <p>The balancer automatically exits when any of the following five 
 conditions is satisfied:
 <ol>
 <li>The cluster is balanced;
 <li>No block can be moved;
 <li>No block has been moved for specified consecutive iterations (5 by default);
 <li>An IOException occurs while communicating with the namenode;
 <li>Another balancer is running.
 </ol>
 
 <p>Upon exit, a balancer returns an exit code and prints one of the 
 following messages to the output file in corresponding to the above exit 
 reasons:
 <ol>
 <li>The cluster is balanced. Exiting
 <li>No block can be moved. Exiting...
 <li>No block has been moved for specified iterations (5 by default). Exiting...
 <li>Received an IO exception: failure reason. Exiting...
 <li>Another balancer is running. Exiting...
 </ol>
 
 <p>The administrator can interrupt the execution of the balancer at any 
 time by running the command "stop-balancer.sh" on the machine where the 
 balancer is running.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Cli.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Cli</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Parameters.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Parameters</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Result.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Result</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.Source.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.Source</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#aboveAvgUtilized">aboveAvgUtilized</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static org.apache.hadoop.fs.Path</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#BALANCER_ID_PATH">BALANCER_ID_PATH</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#belowAvgUtilized">belowAvgUtilized</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#dispatcher">dispatcher</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#GB">GB</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static org.apache.commons.logging.Log</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#LOG">LOG</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#MAX_SIZE_TO_MOVE">MAX_SIZE_TO_MOVE</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.Source.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.Source</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#overUtilized">overUtilized</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/BalancingPolicy.html" title="class in org.apache.hadoop.hdfs.server.balancer">BalancingPolicy</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#policy">policy</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private double</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#threshold">threshold</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#underUtilized">underUtilized</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#USAGE">USAGE</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#Balancer(org.apache.hadoop.hdfs.server.balancer.NameNodeConnector,%20org.apache.hadoop.hdfs.server.balancer.Balancer.Parameters,%20org.apache.hadoop.conf.Configuration)">Balancer</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/NameNodeConnector.html" title="class in org.apache.hadoop.hdfs.server.balancer">NameNodeConnector</a>&nbsp;theblockpool,
                <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Parameters.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Parameters</a>&nbsp;p,
                org.apache.hadoop.conf.Configuration&nbsp;conf)</code>
<div class="block">Construct a balancer.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#checkReplicationPolicyCompatibility(org.apache.hadoop.conf.Configuration)">checkReplicationPolicyCompatibility</a></strong>(org.apache.hadoop.conf.Configuration&nbsp;conf)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private &lt;C extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;&nbsp;<br>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#choose4One(org.apache.hadoop.hdfs.server.balancer.Dispatcher.DDatanode.StorageGroup,%20java.util.Collection,%20org.apache.hadoop.hdfs.server.balancer.Matcher)">choose4One</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&nbsp;g,
                    <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;C&gt;&nbsp;candidates,
                    <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Matcher.html" title="interface in org.apache.hadoop.hdfs.server.balancer">Matcher</a>&nbsp;matcher)</code>
<div class="block">For the given datanode, choose a candidate and then schedule it.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private &lt;G extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>,C extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;&nbsp;<br>C</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#chooseCandidate(G,%20java.util.Iterator,%20org.apache.hadoop.hdfs.server.balancer.Matcher)">chooseCandidate</a></strong>(G&nbsp;g,
                              <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html?is-external=true" title="class or interface in java.util">Iterator</a>&lt;C&gt;&nbsp;candidates,
                              <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Matcher.html" title="interface in org.apache.hadoop.hdfs.server.balancer">Matcher</a>&nbsp;matcher)</code>
<div class="block">Choose a candidate for the given datanode.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#chooseStorageGroups()">chooseStorageGroups</a></strong>()</code>
<div class="block">Decide all <source, target> pairs and
 the number of bytes to move from a source to a target
 Maximum bytes to be moved per storage group is
 min(1 Band worth of bytes,  MAX_SIZE_TO_MOVE).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private &lt;G extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>,C extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;&nbsp;<br>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#chooseStorageGroups(java.util.Collection,%20java.util.Collection,%20org.apache.hadoop.hdfs.server.balancer.Matcher)">chooseStorageGroups</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;G&gt;&nbsp;groups,
                                      <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;C&gt;&nbsp;candidates,
                                      <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Matcher.html" title="interface in org.apache.hadoop.hdfs.server.balancer">Matcher</a>&nbsp;matcher)</code>
<div class="block">For each datanode, choose matching nodes from the candidates.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#chooseStorageGroups(org.apache.hadoop.hdfs.server.balancer.Matcher)">chooseStorageGroups</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Matcher.html" title="interface in org.apache.hadoop.hdfs.server.balancer">Matcher</a>&nbsp;matcher)</code>
<div class="block">Decide all <source, target> pairs according to the matcher.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#computeMaxSize2Move(long,%20long,%20double,%20double)">computeMaxSize2Move</a></strong>(long&nbsp;capacity,
                                      long&nbsp;remaining,
                                      double&nbsp;utilizationDiff,
                                      double&nbsp;threshold)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#getCapacity(org.apache.hadoop.hdfs.server.protocol.DatanodeStorageReport,%20org.apache.hadoop.fs.StorageType)">getCapacity</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/protocol/DatanodeStorageReport.html" title="class in org.apache.hadoop.hdfs.server.protocol">DatanodeStorageReport</a>&nbsp;report,
                      org.apache.hadoop.fs.StorageType&nbsp;t)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#getRemaining(org.apache.hadoop.hdfs.server.protocol.DatanodeStorageReport,%20org.apache.hadoop.fs.StorageType)">getRemaining</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/protocol/DatanodeStorageReport.html" title="class in org.apache.hadoop.hdfs.server.protocol">DatanodeStorageReport</a>&nbsp;report,
                        org.apache.hadoop.fs.StorageType&nbsp;t)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#init(java.util.List)">init</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/protocol/DatanodeStorageReport.html" title="class in org.apache.hadoop.hdfs.server.protocol">DatanodeStorageReport</a>&gt;&nbsp;reports)</code>
<div class="block">Given a datanode storage set, build a network topology and decide
 over-utilized storages, above average utilized storages, 
 below average utilized storages, and underutilized storages.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static &lt;T extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;&nbsp;<br>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#logUtilizationCollection(java.lang.String,%20java.util.Collection)">logUtilizationCollection</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;name,
                                                <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;T&gt;&nbsp;items)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#logUtilizationCollections()">logUtilizationCollections</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#main(java.lang.String[])">main</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>[]&nbsp;args)</code>
<div class="block">Run a balancer</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#matchSourceWithTargetToMove(org.apache.hadoop.hdfs.server.balancer.Dispatcher.Source,%20org.apache.hadoop.hdfs.server.balancer.Dispatcher.DDatanode.StorageGroup)">matchSourceWithTargetToMove</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.Source.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.Source</a>&nbsp;source,
                                                      <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&nbsp;target)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Result.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Result</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#newResult(org.apache.hadoop.hdfs.server.balancer.ExitStatus)">newResult</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/ExitStatus.html" title="enum in org.apache.hadoop.hdfs.server.balancer">ExitStatus</a>&nbsp;exitStatus)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Result.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Result</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#newResult(org.apache.hadoop.hdfs.server.balancer.ExitStatus,%20long,%20long)">newResult</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/ExitStatus.html" title="enum in org.apache.hadoop.hdfs.server.balancer">ExitStatus</a>&nbsp;exitStatus,
                  long&nbsp;bytesLeftToMove,
                  long&nbsp;bytesBeingMoved)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#precentage2bytes(double,%20long)">precentage2bytes</a></strong>(double&nbsp;precentage,
                                long&nbsp;capacity)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#resetData(org.apache.hadoop.conf.Configuration)">resetData</a></strong>(org.apache.hadoop.conf.Configuration&nbsp;conf)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#run(java.util.Collection,%20org.apache.hadoop.hdfs.server.balancer.Balancer.Parameters,%20org.apache.hadoop.conf.Configuration)">run</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="https://docs.oracle.com/javase/7/docs/api/java/net/URI.html?is-external=true" title="class or interface in java.net">URI</a>&gt;&nbsp;namenodes,
      <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Parameters.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Parameters</a>&nbsp;p,
      org.apache.hadoop.conf.Configuration&nbsp;conf)</code>
<div class="block">Balance all namenodes.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Result.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Result</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#runOneIteration()">runOneIteration</a></strong>()</code>
<div class="block">Run an iteration for all datanodes.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html#time2Str(long)">time2Str</a></strong>(long&nbsp;elapsedTime)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="LOG">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOG</h4>
<pre>static final&nbsp;org.apache.commons.logging.Log <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.167">LOG</a></pre>
</li>
</ul>
<a name="BALANCER_ID_PATH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BALANCER_ID_PATH</h4>
<pre>static final&nbsp;org.apache.hadoop.fs.Path <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.169">BALANCER_ID_PATH</a></pre>
</li>
</ul>
<a name="GB">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>GB</h4>
<pre>private static final&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.171">GB</a></pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../constant-values.html#org.apache.hadoop.hdfs.server.balancer.Balancer.GB">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="MAX_SIZE_TO_MOVE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAX_SIZE_TO_MOVE</h4>
<pre>private static final&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.172">MAX_SIZE_TO_MOVE</a></pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../constant-values.html#org.apache.hadoop.hdfs.server.balancer.Balancer.MAX_SIZE_TO_MOVE">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="USAGE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>USAGE</h4>
<pre>private static final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.174">USAGE</a></pre>
</li>
</ul>
<a name="dispatcher">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dispatcher</h4>
<pre>private final&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.186">dispatcher</a></pre>
</li>
</ul>
<a name="policy">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>policy</h4>
<pre>private final&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/BalancingPolicy.html" title="class in org.apache.hadoop.hdfs.server.balancer">BalancingPolicy</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.187">policy</a></pre>
</li>
</ul>
<a name="threshold">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>threshold</h4>
<pre>private final&nbsp;double <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.188">threshold</a></pre>
</li>
</ul>
<a name="overUtilized">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>overUtilized</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.Source.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.Source</a>&gt; <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.191">overUtilized</a></pre>
</li>
</ul>
<a name="aboveAvgUtilized">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>aboveAvgUtilized</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.Source.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.Source</a>&gt; <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.192">aboveAvgUtilized</a></pre>
</li>
</ul>
<a name="belowAvgUtilized">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>belowAvgUtilized</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt; <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.193">belowAvgUtilized</a></pre>
</li>
</ul>
<a name="underUtilized">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>underUtilized</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt; <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.195">underUtilized</a></pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Balancer(org.apache.hadoop.hdfs.server.balancer.NameNodeConnector, org.apache.hadoop.hdfs.server.balancer.Balancer.Parameters, org.apache.hadoop.conf.Configuration)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Balancer</h4>
<pre><a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.217">Balancer</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/NameNodeConnector.html" title="class in org.apache.hadoop.hdfs.server.balancer">NameNodeConnector</a>&nbsp;theblockpool,
        <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Parameters.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Parameters</a>&nbsp;p,
        org.apache.hadoop.conf.Configuration&nbsp;conf)</pre>
<div class="block">Construct a balancer.
 Initialize balancer. It sets the value of the threshold, and 
 builds the communication proxies to
 namenode as a client and a secondary namenode and retry proxies
 when connection fails.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="checkReplicationPolicyCompatibility(org.apache.hadoop.conf.Configuration)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkReplicationPolicyCompatibility</h4>
<pre>private static&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.201">checkReplicationPolicyCompatibility</a>(org.apache.hadoop.conf.Configuration&nbsp;conf)
                                                 throws <a href="../../../../../../org/apache/hadoop/hdfs/server/namenode/UnsupportedActionException.html" title="class in org.apache.hadoop.hdfs.server.namenode">UnsupportedActionException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/namenode/UnsupportedActionException.html" title="class in org.apache.hadoop.hdfs.server.namenode">UnsupportedActionException</a></code></dd></dl>
</li>
</ul>
<a name="getCapacity(org.apache.hadoop.hdfs.server.protocol.DatanodeStorageReport, org.apache.hadoop.fs.StorageType)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCapacity</h4>
<pre>private static&nbsp;long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.238">getCapacity</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/protocol/DatanodeStorageReport.html" title="class in org.apache.hadoop.hdfs.server.protocol">DatanodeStorageReport</a>&nbsp;report,
               org.apache.hadoop.fs.StorageType&nbsp;t)</pre>
</li>
</ul>
<a name="getRemaining(org.apache.hadoop.hdfs.server.protocol.DatanodeStorageReport, org.apache.hadoop.fs.StorageType)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRemaining</h4>
<pre>private static&nbsp;long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.248">getRemaining</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/protocol/DatanodeStorageReport.html" title="class in org.apache.hadoop.hdfs.server.protocol">DatanodeStorageReport</a>&nbsp;report,
                org.apache.hadoop.fs.StorageType&nbsp;t)</pre>
</li>
</ul>
<a name="init(java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>private&nbsp;long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.267">init</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/protocol/DatanodeStorageReport.html" title="class in org.apache.hadoop.hdfs.server.protocol">DatanodeStorageReport</a>&gt;&nbsp;reports)</pre>
<div class="block">Given a datanode storage set, build a network topology and decide
 over-utilized storages, above average utilized storages, 
 below average utilized storages, and underutilized storages. 
 The input datanode storage set is shuffled in order to randomize
 to the storage matching later on.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the number of bytes needed to move in order to balance the cluster.</dd></dl>
</li>
</ul>
<a name="computeMaxSize2Move(long, long, double, double)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeMaxSize2Move</h4>
<pre>private static&nbsp;long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.325">computeMaxSize2Move</a>(long&nbsp;capacity,
                       long&nbsp;remaining,
                       double&nbsp;utilizationDiff,
                       double&nbsp;threshold)</pre>
</li>
</ul>
<a name="precentage2bytes(double, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>precentage2bytes</h4>
<pre>private static&nbsp;long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.335">precentage2bytes</a>(double&nbsp;precentage,
                    long&nbsp;capacity)</pre>
</li>
</ul>
<a name="logUtilizationCollections()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logUtilizationCollections</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.342">logUtilizationCollections</a>()</pre>
</li>
</ul>
<a name="logUtilizationCollection(java.lang.String, java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logUtilizationCollection</h4>
<pre>private static&nbsp;&lt;T extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.352">logUtilizationCollection</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;name,
                                                                          <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;T&gt;&nbsp;items)</pre>
</li>
</ul>
<a name="chooseStorageGroups()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseStorageGroups</h4>
<pre>private&nbsp;long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.363">chooseStorageGroups</a>()</pre>
<div class="block">Decide all <source, target> pairs and
 the number of bytes to move from a source to a target
 Maximum bytes to be moved per storage group is
 min(1 Band worth of bytes,  MAX_SIZE_TO_MOVE).</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>total number of bytes to move in this iteration</dd></dl>
</li>
</ul>
<a name="chooseStorageGroups(org.apache.hadoop.hdfs.server.balancer.Matcher)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseStorageGroups</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.378">chooseStorageGroups</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Matcher.html" title="interface in org.apache.hadoop.hdfs.server.balancer">Matcher</a>&nbsp;matcher)</pre>
<div class="block">Decide all <source, target> pairs according to the matcher.</div>
</li>
</ul>
<a name="chooseStorageGroups(java.util.Collection, java.util.Collection, org.apache.hadoop.hdfs.server.balancer.Matcher)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseStorageGroups</h4>
<pre>private&nbsp;&lt;G extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>,C extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.405">chooseStorageGroups</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;G&gt;&nbsp;groups,
                                                                                                                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;C&gt;&nbsp;candidates,
                                                                                                                 <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Matcher.html" title="interface in org.apache.hadoop.hdfs.server.balancer">Matcher</a>&nbsp;matcher)</pre>
<div class="block">For each datanode, choose matching nodes from the candidates. Either the
 datanodes or the candidates are source nodes with (utilization > Avg), and
 the others are target nodes with (utilization < Avg).</div>
</li>
</ul>
<a name="choose4One(org.apache.hadoop.hdfs.server.balancer.Dispatcher.DDatanode.StorageGroup, java.util.Collection, org.apache.hadoop.hdfs.server.balancer.Matcher)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>choose4One</h4>
<pre>private&nbsp;&lt;C extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;&nbsp;boolean&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.420">choose4One</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&nbsp;g,
                                                               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;C&gt;&nbsp;candidates,
                                                               <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Matcher.html" title="interface in org.apache.hadoop.hdfs.server.balancer">Matcher</a>&nbsp;matcher)</pre>
<div class="block">For the given datanode, choose a candidate and then schedule it.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true if a candidate is chosen; false if no candidates is chosen.</dd></dl>
</li>
</ul>
<a name="matchSourceWithTargetToMove(org.apache.hadoop.hdfs.server.balancer.Dispatcher.Source, org.apache.hadoop.hdfs.server.balancer.Dispatcher.DDatanode.StorageGroup)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>matchSourceWithTargetToMove</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.439">matchSourceWithTargetToMove</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.Source.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.Source</a>&nbsp;source,
                               <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&nbsp;target)</pre>
</li>
</ul>
<a name="chooseCandidate(org.apache.hadoop.hdfs.server.balancer.Dispatcher.DDatanode.StorageGroup,java.util.Iterator,org.apache.hadoop.hdfs.server.balancer.Matcher)">
<!--   -->
</a><a name="chooseCandidate(G, java.util.Iterator, org.apache.hadoop.hdfs.server.balancer.Matcher)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseCandidate</h4>
<pre>private&nbsp;&lt;G extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>,C extends <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Dispatcher.DDatanode.StorageGroup.html" title="class in org.apache.hadoop.hdfs.server.balancer">Dispatcher.DDatanode.StorageGroup</a>&gt;&nbsp;C&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.451">chooseCandidate</a>(G&nbsp;g,
                                                                                                          <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html?is-external=true" title="class or interface in java.util">Iterator</a>&lt;C&gt;&nbsp;candidates,
                                                                                                          <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Matcher.html" title="interface in org.apache.hadoop.hdfs.server.balancer">Matcher</a>&nbsp;matcher)</pre>
<div class="block">Choose a candidate for the given datanode.</div>
</li>
</ul>
<a name="resetData(org.apache.hadoop.conf.Configuration)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resetData</h4>
<pre>void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.467">resetData</a>(org.apache.hadoop.conf.Configuration&nbsp;conf)</pre>
</li>
</ul>
<a name="newResult(org.apache.hadoop.hdfs.server.balancer.ExitStatus, long, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newResult</h4>
<pre><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Result.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Result</a>&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.499">newResult</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/ExitStatus.html" title="enum in org.apache.hadoop.hdfs.server.balancer">ExitStatus</a>&nbsp;exitStatus,
                        long&nbsp;bytesLeftToMove,
                        long&nbsp;bytesBeingMoved)</pre>
</li>
</ul>
<a name="newResult(org.apache.hadoop.hdfs.server.balancer.ExitStatus)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>newResult</h4>
<pre><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Result.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Result</a>&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.504">newResult</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/ExitStatus.html" title="enum in org.apache.hadoop.hdfs.server.balancer">ExitStatus</a>&nbsp;exitStatus)</pre>
</li>
</ul>
<a name="runOneIteration()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>runOneIteration</h4>
<pre><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Result.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Result</a>&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.509">runOneIteration</a>()</pre>
<div class="block">Run an iteration for all datanodes.</div>
</li>
</ul>
<a name="run(java.util.Collection, org.apache.hadoop.hdfs.server.balancer.Balancer.Parameters, org.apache.hadoop.conf.Configuration)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>static&nbsp;int&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.566">run</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="https://docs.oracle.com/javase/7/docs/api/java/net/URI.html?is-external=true" title="class or interface in java.net">URI</a>&gt;&nbsp;namenodes,
      <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Parameters.html" title="class in org.apache.hadoop.hdfs.server.balancer">Balancer.Parameters</a>&nbsp;p,
      org.apache.hadoop.conf.Configuration&nbsp;conf)
        throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
               <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Balance all namenodes.
 For each iteration,
 for each namenode,
 execute a <a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.html" title="class in org.apache.hadoop.hdfs.server.balancer"><code>Balancer</code></a> to work through all datanodes once.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="time2Str(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>time2Str</h4>
<pre>private static&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.615">time2Str</a>(long&nbsp;elapsedTime)</pre>
</li>
</ul>
<a name="main(java.lang.String[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/balancer/Balancer.html#line.788">main</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>[]&nbsp;args)</pre>
<div class="block">Run a balancer</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>args</code> - Command line arguments</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Balancer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/balancer/Balancer.Cli.html" title="class in org.apache.hadoop.hdfs.server.balancer"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hdfs/server/balancer/Balancer.html" target="_top">Frames</a></li>
<li><a href="Balancer.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
