<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Wed Jun 10 23:40:15 EDT 2015 -->
<title>BlockPlacementPolicyDefault</title>
<meta name="date" content="2015-06-10">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BlockPlacementPolicyDefault";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockPlacementPolicyDefault.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyWithNodeGroup.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html" target="_top">Frames</a></li>
<li><a href="BlockPlacementPolicyDefault.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_classes_inherited_from_class_org.apache.hadoop.hdfs.server.blockmanagement.BlockPlacementPolicy">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.hadoop.hdfs.server.blockmanagement</div>
<h2 title="Class BlockPlacementPolicyDefault" class="title">Class BlockPlacementPolicyDefault</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">org.apache.hadoop.hdfs.server.blockmanagement.BlockPlacementPolicy</a></li>
<li>
<ul class="inheritance">
<li>org.apache.hadoop.hdfs.server.blockmanagement.BlockPlacementPolicyDefault</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyWithNodeGroup.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicyWithNodeGroup</a></dd>
</dl>
<hr>
<br>
<pre>@InterfaceAudience.Private
public class <span class="strong">BlockPlacementPolicyDefault</span>
extends <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></pre>
<div class="block">The class is responsible for choosing the desired number of targets
 for placing block replicas.
 The replica placement strategy is that if the writer is on a datanode,
 the 1st replica is placed on the local machine, 
 otherwise a random datanode. The 2nd replica is placed on a datanode
 that is on a different rack. The 3rd replica is placed on a datanode
 which is on a different node of the rack as the second replica.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="nested_classes_inherited_from_class_org.apache.hadoop.hdfs.server.blockmanagement.BlockPlacementPolicy">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from class&nbsp;org.apache.hadoop.hdfs.server.blockmanagement.<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></h3>
<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected org.apache.hadoop.net.NetworkTopology</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#clusterMap">clusterMap</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#considerLoad">considerLoad</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/ThreadLocal.html?is-external=true" title="class or interface in java.lang">ThreadLocal</a>&lt;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html?is-external=true" title="class or interface in java.lang">StringBuilder</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#debugLoggingBuilder">debugLoggingBuilder</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#enableDebugLogging">enableDebugLogging</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#heartbeatInterval">heartbeatInterval</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/Host2NodesMap.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">Host2NodesMap</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#host2datanodeMap">host2datanodeMap</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#preferLocalNode">preferLocalNode</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#staleInterval">staleInterval</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/FSClusterStats.html" title="interface in org.apache.hadoop.hdfs.server.blockmanagement">FSClusterStats</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#stats">stats</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#tolerateHeartbeatMultiplier">tolerateHeartbeatMultiplier</a></strong></code>
<div class="block">A miss of that many heartbeats is tolerated for replica deletion policy.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_org.apache.hadoop.hdfs.server.blockmanagement.BlockPlacementPolicy">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;org.apache.hadoop.hdfs.server.blockmanagement.<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></h3>
<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#LOG">LOG</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#BlockPlacementPolicyDefault()">BlockPlacementPolicyDefault</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#addIfIsGoodTarget(org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo,%20java.util.Set,%20long,%20int,%20boolean,%20java.util.List,%20boolean,%20org.apache.hadoop.fs.StorageType)">addIfIsGoodTarget</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;storage,
                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                 long&nbsp;blockSize,
                 int&nbsp;maxNodesPerRack,
                 boolean&nbsp;considerLoad,
                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                 boolean&nbsp;avoidStaleNodes,
                 org.apache.hadoop.fs.StorageType&nbsp;storageType)</code>
<div class="block">If the given storage is a good target, add it to the result list and
 update the set of excluded nodes.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#addToExcludedNodes(org.apache.hadoop.hdfs.server.blockmanagement.DatanodeDescriptor,%20java.util.Set)">addToExcludedNodes</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeDescriptor.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeDescriptor</a>&nbsp;localMachine,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes)</code>
<div class="block">Add <i>localMachine</i> and related nodes to <i>excludedNodes</i>
 for next replica choosing.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseFromNextRack(org.apache.hadoop.net.Node,%20java.util.Set,%20long,%20int,%20java.util.List,%20boolean,%20java.util.EnumMap)">chooseFromNextRack</a></strong>(org.apache.hadoop.net.Node&nbsp;next,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                  long&nbsp;blocksize,
                  int&nbsp;maxNodesPerRack,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                  boolean&nbsp;avoidStaleNodes,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseLocalRack(org.apache.hadoop.net.Node,%20java.util.Set,%20long,%20int,%20java.util.List,%20boolean,%20java.util.EnumMap)">chooseLocalRack</a></strong>(org.apache.hadoop.net.Node&nbsp;localMachine,
               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
               long&nbsp;blocksize,
               int&nbsp;maxNodesPerRack,
               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
               boolean&nbsp;avoidStaleNodes,
               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)</code>
<div class="block">Choose one node from the rack that <i>localMachine</i> is on.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseLocalStorage(org.apache.hadoop.net.Node,%20java.util.Set,%20long,%20int,%20java.util.List,%20boolean,%20java.util.EnumMap,%20boolean)">chooseLocalStorage</a></strong>(org.apache.hadoop.net.Node&nbsp;localMachine,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                  long&nbsp;blocksize,
                  int&nbsp;maxNodesPerRack,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                  boolean&nbsp;avoidStaleNodes,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes,
                  boolean&nbsp;fallbackToLocalRack)</code>
<div class="block">Choose <i>localMachine</i> as the target.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseRandom(int,%20java.lang.String,%20java.util.Set,%20long,%20int,%20java.util.List,%20boolean,%20java.util.EnumMap)">chooseRandom</a></strong>(int&nbsp;numOfReplicas,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;scope,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
            long&nbsp;blocksize,
            int&nbsp;maxNodesPerRack,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
            boolean&nbsp;avoidStaleNodes,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)</code>
<div class="block">Randomly choose <i>numOfReplicas</i> targets from the given <i>scope</i>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseRandom(java.lang.String,%20java.util.Set,%20long,%20int,%20java.util.List,%20boolean,%20java.util.EnumMap)">chooseRandom</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;scope,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
            long&nbsp;blocksize,
            int&nbsp;maxNodesPerRack,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
            boolean&nbsp;avoidStaleNodes,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)</code>
<div class="block">Randomly choose one target from the given <i>scope</i>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseRemoteRack(int,%20org.apache.hadoop.hdfs.server.blockmanagement.DatanodeDescriptor,%20java.util.Set,%20long,%20int,%20java.util.List,%20boolean,%20java.util.EnumMap)">chooseRemoteRack</a></strong>(int&nbsp;numOfReplicas,
                <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeDescriptor.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeDescriptor</a>&nbsp;localMachine,
                <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                long&nbsp;blocksize,
                int&nbsp;maxReplicasPerRack,
                <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                boolean&nbsp;avoidStaleNodes,
                <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)</code>
<div class="block">Choose <i>numOfReplicas</i> nodes from the racks 
 that <i>localMachine</i> is NOT on.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseReplicaToDelete(org.apache.hadoop.hdfs.server.blockmanagement.BlockCollection,%20org.apache.hadoop.hdfs.protocol.Block,%20short,%20java.util.Collection,%20java.util.Collection,%20java.util.List)">chooseReplicaToDelete</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockCollection.html" title="interface in org.apache.hadoop.hdfs.server.blockmanagement">BlockCollection</a>&nbsp;bc,
                     <a href="../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;block,
                     short&nbsp;replicationFactor,
                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;first,
                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;second,
                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;org.apache.hadoop.fs.StorageType&gt;&nbsp;excessTypes)</code>
<div class="block">Decide whether deleting the specified replica of the block still makes 
 the block conform to the configured block placement policy.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseTarget(int,%20org.apache.hadoop.net.Node,%20java.util.List,%20boolean,%20java.util.Set,%20long,%20org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">chooseTarget</a></strong>(int&nbsp;numOfReplicas,
            org.apache.hadoop.net.Node&nbsp;writer,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;chosenStorage,
            boolean&nbsp;returnChosenNodes,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
            long&nbsp;blocksize,
            <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol">BlockStoragePolicy</a>&nbsp;storagePolicy)</code>
<div class="block">This is the implementation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.apache.hadoop.net.Node</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseTarget(int,%20org.apache.hadoop.net.Node,%20java.util.Set,%20long,%20int,%20java.util.List,%20boolean,%20org.apache.hadoop.hdfs.protocol.BlockStoragePolicy,%20java.util.EnumSet,%20boolean)">chooseTarget</a></strong>(int&nbsp;numOfReplicas,
            org.apache.hadoop.net.Node&nbsp;writer,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
            long&nbsp;blocksize,
            int&nbsp;maxNodesPerRack,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
            boolean&nbsp;avoidStaleNodes,
            <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol">BlockStoragePolicy</a>&nbsp;storagePolicy,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumSet.html?is-external=true" title="class or interface in java.util">EnumSet</a>&lt;org.apache.hadoop.fs.StorageType&gt;&nbsp;unavailableStorages,
            boolean&nbsp;newBlock)</code>
<div class="block">choose <i>numOfReplicas</i> from all data nodes</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseTarget(java.lang.String,%20int,%20org.apache.hadoop.net.Node,%20java.util.List,%20boolean,%20java.util.Set,%20long,%20org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">chooseTarget</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;srcPath,
            int&nbsp;numOfReplicas,
            org.apache.hadoop.net.Node&nbsp;writer,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;chosenNodes,
            boolean&nbsp;returnChosenNodes,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
            long&nbsp;blocksize,
            <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol">BlockStoragePolicy</a>&nbsp;storagePolicy)</code>
<div class="block">choose <i>numOfReplicas</i> data nodes for <i>writer</i> 
 to re-replicate a block with size <i>blocksize</i> 
 If not, return as many as we can.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#chooseTarget(java.lang.String,%20int,%20org.apache.hadoop.net.Node,%20java.util.Set,%20long,%20java.util.List,%20org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">chooseTarget</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;src,
            int&nbsp;numOfReplicas,
            org.apache.hadoop.net.Node&nbsp;writer,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
            long&nbsp;blocksize,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeDescriptor.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeDescriptor</a>&gt;&nbsp;favoredNodes,
            <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol">BlockStoragePolicy</a>&nbsp;storagePolicy)</code>
<div class="block">Same as <code>#chooseTarget(String, int, Node, Set, long, List, StorageType)</code>
 with added parameter <code>favoredDatanodes</code></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#getMaxNodesPerRack(int,%20int)">getMaxNodesPerRack</a></strong>(int&nbsp;numOfChosen,
                  int&nbsp;numOfReplicas)</code>
<div class="block">Calculate the maximum number of replicas to allocate per rack.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#getPipeline(org.apache.hadoop.net.Node,%20org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo[])">getPipeline</a></strong>(org.apache.hadoop.net.Node&nbsp;writer,
           <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]&nbsp;storages)</code>
<div class="block">Return a pipeline of nodes.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#getRequiredStorageTypes(java.util.List)">getRequiredStorageTypes</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;org.apache.hadoop.fs.StorageType&gt;&nbsp;types)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#initialize(org.apache.hadoop.conf.Configuration,%20org.apache.hadoop.hdfs.server.blockmanagement.FSClusterStats,%20org.apache.hadoop.net.NetworkTopology,%20org.apache.hadoop.hdfs.server.blockmanagement.Host2NodesMap)">initialize</a></strong>(org.apache.hadoop.conf.Configuration&nbsp;conf,
          <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/FSClusterStats.html" title="interface in org.apache.hadoop.hdfs.server.blockmanagement">FSClusterStats</a>&nbsp;stats,
          org.apache.hadoop.net.NetworkTopology&nbsp;clusterMap,
          <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/Host2NodesMap.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">Host2NodesMap</a>&nbsp;host2datanodeMap)</code>
<div class="block">Used to setup a BlockPlacementPolicy object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#isGoodTarget(org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo,%20long,%20int,%20boolean,%20java.util.List,%20boolean,%20org.apache.hadoop.fs.StorageType)">isGoodTarget</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;storage,
            long&nbsp;blockSize,
            int&nbsp;maxTargetPerRack,
            boolean&nbsp;considerLoad,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
            boolean&nbsp;avoidStaleNodes,
            org.apache.hadoop.fs.StorageType&nbsp;requiredStorageType)</code>
<div class="block">Determine if a storage is a good target.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#logNodeIsNotChosen(org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo,%20java.lang.String)">logNodeIsNotChosen</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;storage,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;reason)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#pickupReplicaSet(java.util.Collection,%20java.util.Collection)">pickupReplicaSet</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;first,
                <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;second)</code>
<div class="block">Pick up replica node set for deleting replica as over-replicated.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#setPreferLocalNode(boolean)">setPreferLocalNode</a></strong>(boolean&nbsp;prefer)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementStatus.html" title="interface in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementStatus</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html#verifyBlockPlacement(java.lang.String,%20org.apache.hadoop.hdfs.protocol.LocatedBlock,%20int)">verifyBlockPlacement</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;srcPath,
                    <a href="../../../../../../org/apache/hadoop/hdfs/protocol/LocatedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">LocatedBlock</a>&nbsp;lBlk,
                    int&nbsp;numberOfReplicas)</code>
<div class="block">Verify if the block's placement meets requirement of placement policy,
 i.e.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.apache.hadoop.hdfs.server.blockmanagement.BlockPlacementPolicy">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.apache.hadoop.hdfs.server.blockmanagement.<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></h3>
<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#adjustSetsWithChosenReplica(java.util.Map,%20java.util.List,%20java.util.List,%20org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo)">adjustSetsWithChosenReplica</a>, <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#getInstance(org.apache.hadoop.conf.Configuration,%20org.apache.hadoop.hdfs.server.blockmanagement.FSClusterStats,%20org.apache.hadoop.net.NetworkTopology,%20org.apache.hadoop.hdfs.server.blockmanagement.Host2NodesMap)">getInstance</a>, <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#getRack(org.apache.hadoop.hdfs.protocol.DatanodeInfo)">getRack</a>, <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#splitNodesWithRack(java.lang.Iterable,%20java.util.Map,%20java.util.List,%20java.util.List)">splitNodesWithRack</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="enableDebugLogging">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>enableDebugLogging</h4>
<pre>private static final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> enableDebugLogging</pre>
</li>
</ul>
<a name="debugLoggingBuilder">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>debugLoggingBuilder</h4>
<pre>private static final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/ThreadLocal.html?is-external=true" title="class or interface in java.lang">ThreadLocal</a>&lt;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html?is-external=true" title="class or interface in java.lang">StringBuilder</a>&gt; debugLoggingBuilder</pre>
</li>
</ul>
<a name="considerLoad">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>considerLoad</h4>
<pre>protected&nbsp;boolean considerLoad</pre>
</li>
</ul>
<a name="preferLocalNode">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>preferLocalNode</h4>
<pre>private&nbsp;boolean preferLocalNode</pre>
</li>
</ul>
<a name="clusterMap">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clusterMap</h4>
<pre>protected&nbsp;org.apache.hadoop.net.NetworkTopology clusterMap</pre>
</li>
</ul>
<a name="host2datanodeMap">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>host2datanodeMap</h4>
<pre>protected&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/Host2NodesMap.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">Host2NodesMap</a> host2datanodeMap</pre>
</li>
</ul>
<a name="stats">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stats</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/FSClusterStats.html" title="interface in org.apache.hadoop.hdfs.server.blockmanagement">FSClusterStats</a> stats</pre>
</li>
</ul>
<a name="heartbeatInterval">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>heartbeatInterval</h4>
<pre>protected&nbsp;long heartbeatInterval</pre>
</li>
</ul>
<a name="staleInterval">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>staleInterval</h4>
<pre>private&nbsp;long staleInterval</pre>
</li>
</ul>
<a name="tolerateHeartbeatMultiplier">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>tolerateHeartbeatMultiplier</h4>
<pre>protected&nbsp;int tolerateHeartbeatMultiplier</pre>
<div class="block">A miss of that many heartbeats is tolerated for replica deletion policy.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BlockPlacementPolicyDefault()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BlockPlacementPolicyDefault</h4>
<pre>protected&nbsp;BlockPlacementPolicyDefault()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="initialize(org.apache.hadoop.conf.Configuration, org.apache.hadoop.hdfs.server.blockmanagement.FSClusterStats, org.apache.hadoop.net.NetworkTopology, org.apache.hadoop.hdfs.server.blockmanagement.Host2NodesMap)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialize</h4>
<pre>public&nbsp;void&nbsp;initialize(org.apache.hadoop.conf.Configuration&nbsp;conf,
              <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/FSClusterStats.html" title="interface in org.apache.hadoop.hdfs.server.blockmanagement">FSClusterStats</a>&nbsp;stats,
              org.apache.hadoop.net.NetworkTopology&nbsp;clusterMap,
              <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/Host2NodesMap.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">Host2NodesMap</a>&nbsp;host2datanodeMap)</pre>
<div class="block"><strong>Description copied from class:&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#initialize(org.apache.hadoop.conf.Configuration,%20org.apache.hadoop.hdfs.server.blockmanagement.FSClusterStats,%20org.apache.hadoop.net.NetworkTopology,%20org.apache.hadoop.hdfs.server.blockmanagement.Host2NodesMap)">BlockPlacementPolicy</a></code></strong></div>
<div class="block">Used to setup a BlockPlacementPolicy object. This should be defined by 
 all implementations of a BlockPlacementPolicy.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#initialize(org.apache.hadoop.conf.Configuration,%20org.apache.hadoop.hdfs.server.blockmanagement.FSClusterStats,%20org.apache.hadoop.net.NetworkTopology,%20org.apache.hadoop.hdfs.server.blockmanagement.Host2NodesMap)">initialize</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>conf</code> - the configuration object</dd><dd><code>stats</code> - retrieve cluster status from here</dd><dd><code>clusterMap</code> - cluster topology</dd></dl>
</li>
</ul>
<a name="chooseTarget(java.lang.String, int, org.apache.hadoop.net.Node, java.util.List, boolean, java.util.Set, long, org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseTarget</h4>
<pre>public&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]&nbsp;chooseTarget(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;srcPath,
                                 int&nbsp;numOfReplicas,
                                 org.apache.hadoop.net.Node&nbsp;writer,
                                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;chosenNodes,
                                 boolean&nbsp;returnChosenNodes,
                                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                                 long&nbsp;blocksize,
                                 <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol">BlockStoragePolicy</a>&nbsp;storagePolicy)</pre>
<div class="block"><strong>Description copied from class:&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#chooseTarget(java.lang.String,%20int,%20org.apache.hadoop.net.Node,%20java.util.List,%20boolean,%20java.util.Set,%20long,%20org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">BlockPlacementPolicy</a></code></strong></div>
<div class="block">choose <i>numOfReplicas</i> data nodes for <i>writer</i> 
 to re-replicate a block with size <i>blocksize</i> 
 If not, return as many as we can.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#chooseTarget(java.lang.String,%20int,%20org.apache.hadoop.net.Node,%20java.util.List,%20boolean,%20java.util.Set,%20long,%20org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">chooseTarget</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>srcPath</code> - the file to which this chooseTargets is being invoked.</dd><dd><code>numOfReplicas</code> - additional number of replicas wanted.</dd><dd><code>writer</code> - the writer's machine, null if not in the cluster.</dd><dd><code>chosenNodes</code> - datanodes that have been chosen as targets.</dd><dd><code>returnChosenNodes</code> - decide if the chosenNodes are returned.</dd><dd><code>excludedNodes</code> - datanodes that should not be considered as targets.</dd><dd><code>blocksize</code> - size of the data to be written.</dd>
<dt><span class="strong">Returns:</span></dt><dd>array of DatanodeDescriptor instances chosen as target
 and sorted as a pipeline.</dd></dl>
</li>
</ul>
<a name="chooseTarget(java.lang.String, int, org.apache.hadoop.net.Node, java.util.Set, long, java.util.List, org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseTarget</h4>
<pre><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]&nbsp;chooseTarget(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;src,
                                 int&nbsp;numOfReplicas,
                                 org.apache.hadoop.net.Node&nbsp;writer,
                                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                                 long&nbsp;blocksize,
                                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeDescriptor.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeDescriptor</a>&gt;&nbsp;favoredNodes,
                                 <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol">BlockStoragePolicy</a>&nbsp;storagePolicy)</pre>
<div class="block"><strong>Description copied from class:&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#chooseTarget(java.lang.String,%20int,%20org.apache.hadoop.net.Node,%20java.util.Set,%20long,%20java.util.List,%20org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">BlockPlacementPolicy</a></code></strong></div>
<div class="block">Same as <code>#chooseTarget(String, int, Node, Set, long, List, StorageType)</code>
 with added parameter <code>favoredDatanodes</code></div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#chooseTarget(java.lang.String,%20int,%20org.apache.hadoop.net.Node,%20java.util.Set,%20long,%20java.util.List,%20org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">chooseTarget</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></code></dd>
<dd><code>favoredNodes</code> - datanodes that should be favored as targets. This
          is only a hint and due to cluster state, namenode may not be 
          able to place the blocks on these datanodes.</dd></dl>
</li>
</ul>
<a name="chooseTarget(int, org.apache.hadoop.net.Node, java.util.List, boolean, java.util.Set, long, org.apache.hadoop.hdfs.protocol.BlockStoragePolicy)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseTarget</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]&nbsp;chooseTarget(int&nbsp;numOfReplicas,
                                 org.apache.hadoop.net.Node&nbsp;writer,
                                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;chosenStorage,
                                 boolean&nbsp;returnChosenNodes,
                                 <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                                 long&nbsp;blocksize,
                                 <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol">BlockStoragePolicy</a>&nbsp;storagePolicy)</pre>
<div class="block">This is the implementation.</div>
</li>
</ul>
<a name="getMaxNodesPerRack(int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxNodesPerRack</h4>
<pre>private&nbsp;int[]&nbsp;getMaxNodesPerRack(int&nbsp;numOfChosen,
                       int&nbsp;numOfReplicas)</pre>
<div class="block">Calculate the maximum number of replicas to allocate per rack. It also
 limits the total number of replicas to the total number of nodes in the
 cluster. Caller should adjust the replica count to the return value.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>numOfChosen</code> - The number of already chosen nodes.</dd><dd><code>numOfReplicas</code> - The number of additional nodes to allocate.</dd>
<dt><span class="strong">Returns:</span></dt><dd>integer array. Index 0: The number of nodes allowed to allocate
         in addition to already chosen nodes.
         Index 1: The maximum allowed number of nodes per rack. This
         is independent of the number of chosen nodes, as it is calculated
         using the target number of replicas.</dd></dl>
</li>
</ul>
<a name="getRequiredStorageTypes(java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRequiredStorageTypes</h4>
<pre>private&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;getRequiredStorageTypes(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;org.apache.hadoop.fs.StorageType&gt;&nbsp;types)</pre>
</li>
</ul>
<a name="chooseTarget(int, org.apache.hadoop.net.Node, java.util.Set, long, int, java.util.List, boolean, org.apache.hadoop.hdfs.protocol.BlockStoragePolicy, java.util.EnumSet, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseTarget</h4>
<pre>private&nbsp;org.apache.hadoop.net.Node&nbsp;chooseTarget(int&nbsp;numOfReplicas,
                                      org.apache.hadoop.net.Node&nbsp;writer,
                                      <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                                      long&nbsp;blocksize,
                                      int&nbsp;maxNodesPerRack,
                                      <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                                      boolean&nbsp;avoidStaleNodes,
                                      <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol">BlockStoragePolicy</a>&nbsp;storagePolicy,
                                      <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumSet.html?is-external=true" title="class or interface in java.util">EnumSet</a>&lt;org.apache.hadoop.fs.StorageType&gt;&nbsp;unavailableStorages,
                                      boolean&nbsp;newBlock)</pre>
<div class="block">choose <i>numOfReplicas</i> from all data nodes</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>numOfReplicas</code> - additional number of replicas wanted</dd><dd><code>writer</code> - the writer's machine, could be a non-DatanodeDescriptor node</dd><dd><code>excludedNodes</code> - datanodes that should not be considered as targets</dd><dd><code>blocksize</code> - size of the data to be written</dd><dd><code>maxNodesPerRack</code> - max nodes allowed per rack</dd><dd><code>results</code> - the target nodes already chosen</dd><dd><code>avoidStaleNodes</code> - avoid stale nodes in replica choosing</dd>
<dt><span class="strong">Returns:</span></dt><dd>local node of writer (not chosen node)</dd></dl>
</li>
</ul>
<a name="chooseLocalStorage(org.apache.hadoop.net.Node, java.util.Set, long, int, java.util.List, boolean, java.util.EnumMap, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseLocalStorage</h4>
<pre>protected&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;chooseLocalStorage(org.apache.hadoop.net.Node&nbsp;localMachine,
                                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                                     long&nbsp;blocksize,
                                     int&nbsp;maxNodesPerRack,
                                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                                     boolean&nbsp;avoidStaleNodes,
                                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes,
                                     boolean&nbsp;fallbackToLocalRack)
                                          throws <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></pre>
<div class="block">Choose <i>localMachine</i> as the target.
 if <i>localMachine</i> is not available, 
 choose a node on the same rack</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the chosen storage</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></code></dd></dl>
</li>
</ul>
<a name="addToExcludedNodes(org.apache.hadoop.hdfs.server.blockmanagement.DatanodeDescriptor, java.util.Set)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addToExcludedNodes</h4>
<pre>protected&nbsp;int&nbsp;addToExcludedNodes(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeDescriptor.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeDescriptor</a>&nbsp;localMachine,
                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes)</pre>
<div class="block">Add <i>localMachine</i> and related nodes to <i>excludedNodes</i>
 for next replica choosing. In sub class, we can add more nodes within
 the same failure domain of localMachine</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>number of new excluded nodes</dd></dl>
</li>
</ul>
<a name="chooseLocalRack(org.apache.hadoop.net.Node, java.util.Set, long, int, java.util.List, boolean, java.util.EnumMap)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseLocalRack</h4>
<pre>protected&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;chooseLocalRack(org.apache.hadoop.net.Node&nbsp;localMachine,
                                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                                  long&nbsp;blocksize,
                                  int&nbsp;maxNodesPerRack,
                                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                                  boolean&nbsp;avoidStaleNodes,
                                  <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)
                                       throws <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></pre>
<div class="block">Choose one node from the rack that <i>localMachine</i> is on.
 if no such node is available, choose one node from the rack where
 a second replica is on.
 if still no such node is available, choose a random node 
 in the cluster.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the chosen node</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></code></dd></dl>
</li>
</ul>
<a name="chooseFromNextRack(org.apache.hadoop.net.Node, java.util.Set, long, int, java.util.List, boolean, java.util.EnumMap)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseFromNextRack</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;chooseFromNextRack(org.apache.hadoop.net.Node&nbsp;next,
                                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                                     long&nbsp;blocksize,
                                     int&nbsp;maxNodesPerRack,
                                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                                     boolean&nbsp;avoidStaleNodes,
                                     <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)
                                        throws <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></code></dd></dl>
</li>
</ul>
<a name="chooseRemoteRack(int, org.apache.hadoop.hdfs.server.blockmanagement.DatanodeDescriptor, java.util.Set, long, int, java.util.List, boolean, java.util.EnumMap)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseRemoteRack</h4>
<pre>protected&nbsp;void&nbsp;chooseRemoteRack(int&nbsp;numOfReplicas,
                    <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeDescriptor.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeDescriptor</a>&nbsp;localMachine,
                    <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                    long&nbsp;blocksize,
                    int&nbsp;maxReplicasPerRack,
                    <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                    boolean&nbsp;avoidStaleNodes,
                    <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)
                         throws <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></pre>
<div class="block">Choose <i>numOfReplicas</i> nodes from the racks 
 that <i>localMachine</i> is NOT on.
 if not enough nodes are available, choose the remaining ones 
 from the local rack</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></code></dd></dl>
</li>
</ul>
<a name="chooseRandom(java.lang.String, java.util.Set, long, int, java.util.List, boolean, java.util.EnumMap)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseRandom</h4>
<pre>protected&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;chooseRandom(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;scope,
                               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                               long&nbsp;blocksize,
                               int&nbsp;maxNodesPerRack,
                               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                               boolean&nbsp;avoidStaleNodes,
                               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)
                                    throws <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></pre>
<div class="block">Randomly choose one target from the given <i>scope</i>.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the chosen storage, if there is any.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></code></dd></dl>
</li>
</ul>
<a name="chooseRandom(int, java.lang.String, java.util.Set, long, int, java.util.List, boolean, java.util.EnumMap)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseRandom</h4>
<pre>protected&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;chooseRandom(int&nbsp;numOfReplicas,
                               <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;scope,
                               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                               long&nbsp;blocksize,
                               int&nbsp;maxNodesPerRack,
                               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                               boolean&nbsp;avoidStaleNodes,
                               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html?is-external=true" title="class or interface in java.util">EnumMap</a>&lt;org.apache.hadoop.fs.StorageType,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;&nbsp;storageTypes)
                                    throws <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></pre>
<div class="block">Randomly choose <i>numOfReplicas</i> targets from the given <i>scope</i>.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the first chosen node, if there is any.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy.NotEnoughReplicasException</a></code></dd></dl>
</li>
</ul>
<a name="addIfIsGoodTarget(org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo, java.util.Set, long, int, boolean, java.util.List, boolean, org.apache.hadoop.fs.StorageType)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addIfIsGoodTarget</h4>
<pre>int&nbsp;addIfIsGoodTarget(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;storage,
                    <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Set.html?is-external=true" title="class or interface in java.util">Set</a>&lt;org.apache.hadoop.net.Node&gt;&nbsp;excludedNodes,
                    long&nbsp;blockSize,
                    int&nbsp;maxNodesPerRack,
                    boolean&nbsp;considerLoad,
                    <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                    boolean&nbsp;avoidStaleNodes,
                    org.apache.hadoop.fs.StorageType&nbsp;storageType)</pre>
<div class="block">If the given storage is a good target, add it to the result list and
 update the set of excluded nodes.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>-1 if the given is not a good target;
         otherwise, return the number of nodes added to excludedNodes set.</dd></dl>
</li>
</ul>
<a name="logNodeIsNotChosen(org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logNodeIsNotChosen</h4>
<pre>private static&nbsp;void&nbsp;logNodeIsNotChosen(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;storage,
                      <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;reason)</pre>
</li>
</ul>
<a name="isGoodTarget(org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo, long, int, boolean, java.util.List, boolean, org.apache.hadoop.fs.StorageType)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isGoodTarget</h4>
<pre>private&nbsp;boolean&nbsp;isGoodTarget(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;storage,
                   long&nbsp;blockSize,
                   int&nbsp;maxTargetPerRack,
                   boolean&nbsp;considerLoad,
                   <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;results,
                   boolean&nbsp;avoidStaleNodes,
                   org.apache.hadoop.fs.StorageType&nbsp;requiredStorageType)</pre>
<div class="block">Determine if a storage is a good target.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>storage</code> - The target storage</dd><dd><code>blockSize</code> - Size of block</dd><dd><code>maxTargetPerRack</code> - Maximum number of targets per rack. The value of 
                       this parameter depends on the number of racks in 
                       the cluster and total number of replicas for a block</dd><dd><code>considerLoad</code> - whether or not to consider load of the target node</dd><dd><code>results</code> - A list containing currently chosen nodes. Used to check if 
                too many nodes has been chosen in the target rack.</dd><dd><code>avoidStaleNodes</code> - Whether or not to avoid choosing stale nodes</dd>
<dt><span class="strong">Returns:</span></dt><dd>Return true if <i>node</i> has enough space, 
         does not have too much load, 
         and the rack does not have too many nodes.</dd></dl>
</li>
</ul>
<a name="getPipeline(org.apache.hadoop.net.Node, org.apache.hadoop.hdfs.server.blockmanagement.DatanodeStorageInfo[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPipeline</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]&nbsp;getPipeline(org.apache.hadoop.net.Node&nbsp;writer,
                                <a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>[]&nbsp;storages)</pre>
<div class="block">Return a pipeline of nodes.
 The pipeline is formed finding a shortest path that 
 starts from the writer and traverses all <i>nodes</i>
 This is basically a traveling salesman problem.</div>
</li>
</ul>
<a name="verifyBlockPlacement(java.lang.String, org.apache.hadoop.hdfs.protocol.LocatedBlock, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyBlockPlacement</h4>
<pre>public&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementStatus.html" title="interface in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementStatus</a>&nbsp;verifyBlockPlacement(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;srcPath,
                                        <a href="../../../../../../org/apache/hadoop/hdfs/protocol/LocatedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">LocatedBlock</a>&nbsp;lBlk,
                                        int&nbsp;numberOfReplicas)</pre>
<div class="block"><strong>Description copied from class:&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#verifyBlockPlacement(java.lang.String,%20org.apache.hadoop.hdfs.protocol.LocatedBlock,%20int)">BlockPlacementPolicy</a></code></strong></div>
<div class="block">Verify if the block's placement meets requirement of placement policy,
 i.e. replicas are placed on no less than minRacks racks in the system.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#verifyBlockPlacement(java.lang.String,%20org.apache.hadoop.hdfs.protocol.LocatedBlock,%20int)">verifyBlockPlacement</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>srcPath</code> - the full pathname of the file to be verified</dd><dd><code>lBlk</code> - block with locations</dd><dd><code>numberOfReplicas</code> - replica number of file to be verified</dd>
<dt><span class="strong">Returns:</span></dt><dd>the result of verification</dd></dl>
</li>
</ul>
<a name="chooseReplicaToDelete(org.apache.hadoop.hdfs.server.blockmanagement.BlockCollection, org.apache.hadoop.hdfs.protocol.Block, short, java.util.Collection, java.util.Collection, java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chooseReplicaToDelete</h4>
<pre>public&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&nbsp;chooseReplicaToDelete(<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockCollection.html" title="interface in org.apache.hadoop.hdfs.server.blockmanagement">BlockCollection</a>&nbsp;bc,
                                        <a href="../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;block,
                                        short&nbsp;replicationFactor,
                                        <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;first,
                                        <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;second,
                                        <a href="https://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;org.apache.hadoop.fs.StorageType&gt;&nbsp;excessTypes)</pre>
<div class="block"><strong>Description copied from class:&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#chooseReplicaToDelete(org.apache.hadoop.hdfs.server.blockmanagement.BlockCollection,%20org.apache.hadoop.hdfs.protocol.Block,%20short,%20java.util.Collection,%20java.util.Collection,%20java.util.List)">BlockPlacementPolicy</a></code></strong></div>
<div class="block">Decide whether deleting the specified replica of the block still makes 
 the block conform to the configured block placement policy.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html#chooseReplicaToDelete(org.apache.hadoop.hdfs.server.blockmanagement.BlockCollection,%20org.apache.hadoop.hdfs.protocol.Block,%20short,%20java.util.Collection,%20java.util.Collection,%20java.util.List)">chooseReplicaToDelete</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">BlockPlacementPolicy</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>bc</code> - block collection of file to which block-to-be-deleted belongs</dd><dd><code>block</code> - The block to be deleted</dd><dd><code>replicationFactor</code> - The required number of replicas for this block</dd><dd><code>first</code> - The replica locations of this block that are present
                    on more than one unique racks.</dd><dd><code>second</code> - Replica locations of this block that  are present
                    on exactly one unique racks.</dd><dd><code>excessTypes</code> - The excess <code>StorageType</code>s according to the
                    <a href="../../../../../../org/apache/hadoop/hdfs/protocol/BlockStoragePolicy.html" title="class in org.apache.hadoop.hdfs.protocol"><code>BlockStoragePolicy</code></a>.</dd>
<dt><span class="strong">Returns:</span></dt><dd>the replica that is the best candidate for deletion</dd></dl>
</li>
</ul>
<a name="pickupReplicaSet(java.util.Collection, java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>pickupReplicaSet</h4>
<pre>protected&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;pickupReplicaSet(<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;first,
                                               <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Collection.html?is-external=true" title="class or interface in java.util">Collection</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/DatanodeStorageInfo.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement">DatanodeStorageInfo</a>&gt;&nbsp;second)</pre>
<div class="block">Pick up replica node set for deleting replica as over-replicated. 
 First set contains replica nodes on rack with more than one
 replica while second set contains remaining replica nodes.
 So pick up first set if not empty. If first is empty, then pick second.</div>
</li>
</ul>
<a name="setPreferLocalNode(boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>setPreferLocalNode</h4>
<pre>void&nbsp;setPreferLocalNode(boolean&nbsp;prefer)</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockPlacementPolicyDefault.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicy.NotEnoughReplicasException.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyWithNodeGroup.html" title="class in org.apache.hadoop.hdfs.server.blockmanagement"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hdfs/server/blockmanagement/BlockPlacementPolicyDefault.html" target="_top">Frames</a></li>
<li><a href="BlockPlacementPolicyDefault.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_classes_inherited_from_class_org.apache.hadoop.hdfs.server.blockmanagement.BlockPlacementPolicy">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
