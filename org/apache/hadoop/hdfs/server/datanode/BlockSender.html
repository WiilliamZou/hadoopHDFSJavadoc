<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Wed Jun 10 23:54:06 EDT 2015 -->
<title>BlockSender</title>
<meta name="date" content="2015-06-10">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BlockSender";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockSender.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockScanner.Servlet.html" title="class in org.apache.hadoop.hdfs.server.datanode"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BPOfferService.html" title="class in org.apache.hadoop.hdfs.server.datanode"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hdfs/server/datanode/BlockSender.html" target="_top">Frames</a></li>
<li><a href="BlockSender.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.hadoop.hdfs.server.datanode</div>
<h2 title="Class BlockSender" class="title">Class BlockSender</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.hadoop.hdfs.server.datanode.BlockSender</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="https://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html?is-external=true" title="class or interface in java.io">Closeable</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang">AutoCloseable</a></dd>
</dl>
<hr>
<br>
<pre> class <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.96">BlockSender</a>
extends <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html?is-external=true" title="class or interface in java.io">Closeable</a></pre>
<div class="block">Reads a block from the disk and sends it to a recipient.
 
 Data sent from the BlockeSender in the following format:
 <br><b>Data format:</b> <pre>
    +--------------------------------------------------+
    | ChecksumHeader | Sequence of data PACKETS...     |
    +--------------------------------------------------+ 
 </pre>   
 <b>ChecksumHeader format:</b> <pre>
    +--------------------------------------------------+
    | 1 byte CHECKSUM_TYPE | 4 byte BYTES_PER_CHECKSUM |
    +--------------------------------------------------+ 
 </pre>   
 An empty packet is sent to mark the end of block and read completion.
 
 PACKET Contains a packet header, checksum and data. Amount of data
 carried is set by BUFFER_SIZE.
 <pre>
   +-----------------------------------------------------+
   | Variable length header. See <a href="../../../../../../org/apache/hadoop/hdfs/protocol/datatransfer/PacketHeader.html" title="class in org.apache.hadoop.hdfs.protocol.datatransfer"><code>PacketHeader</code></a>    |
   +-----------------------------------------------------+
   | x byte checksum data. x is defined below            |
   +-----------------------------------------------------+
   | actual data ......                                  |
   +-----------------------------------------------------+
 
   Data is made of Chunks. Each chunk is of length <= BYTES_PER_CHECKSUM.
   A checksum is calculated for each chunk.
  
   x = (length of data + BYTE_PER_CHECKSUM - 1)/BYTES_PER_CHECKSUM *
       CHECKSUM_SIZE
  
   CHECKSUM_SIZE depends on CHECKSUM_TYPE (usually, 4 for CRC32) 
  </pre>
  
  The client reads data until it receives a packet with 
  "LastPacketInBlock" set to true or with a zero length. If there is 
  no checksum error, it replies to DataNode with OP_STATUS_CHECKSUM_OK.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#alwaysReadahead">alwaysReadahead</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#block">block</a></strong></code>
<div class="block">the block to read from</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io">InputStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#blockIn">blockIn</a></strong></code>
<div class="block">Stream to read block data from</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/FileDescriptor.html?is-external=true" title="class or interface in java.io">FileDescriptor</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#blockInFd">blockInFd</a></strong></code>
<div class="block">The file descriptor of the block being sent</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#blockInPosition">blockInPosition</a></strong></code>
<div class="block">updated while using transferTo()</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#CACHE_DROP_INTERVAL_BYTES">CACHE_DROP_INTERVAL_BYTES</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.apache.hadoop.util.DataChecksum</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#checksum">checksum</a></strong></code>
<div class="block">Checksum utility</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html?is-external=true" title="class or interface in java.io">DataInputStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#checksumIn">checksumIn</a></strong></code>
<div class="block">Stream to read checksum</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#checksumSize">checksumSize</a></strong></code>
<div class="block">Number bytes of checksum computed for a chunk</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#chunkSize">chunkSize</a></strong></code>
<div class="block">Number of bytes in chunk used for computing checksum</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#clientTraceFmt">clientTraceFmt</a></strong></code>
<div class="block">Format used to print client trace log messages</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static org.apache.commons.logging.Log</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#ClientTraceLog">ClientTraceLog</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#corruptChecksumOk">corruptChecksumOk</a></strong></code>
<div class="block">If true, failure to read checksum is ignored</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private org.apache.hadoop.io.ReadaheadPool.ReadaheadRequest</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#curReadahead">curReadahead</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/DataNode.html" title="class in org.apache.hadoop.hdfs.server.datanode">DataNode</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#datanode">datanode</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#dropCacheBehindAllReads">dropCacheBehindAllReads</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#dropCacheBehindLargeReads">dropCacheBehindLargeReads</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#endOffset">endOffset</a></strong></code>
<div class="block">Position of last byte to read from block file</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#initialOffset">initialOffset</a></strong></code>
<div class="block">Initial position to read</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#is32Bit">is32Bit</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#lastCacheDropOffset">lastCacheDropOffset</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/ChunkChecksum.html" title="class in org.apache.hadoop.hdfs.server.datanode">ChunkChecksum</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#lastChunkChecksum">lastChunkChecksum</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static org.apache.commons.logging.Log</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#LOG">LOG</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#LONG_READ_THRESHOLD_BYTES">LONG_READ_THRESHOLD_BYTES</a></strong></code>
<div class="block">See {<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#isLongRead()"><code>isLongRead()</code></a></div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#MIN_BUFFER_WITH_TRANSFERTO">MIN_BUFFER_WITH_TRANSFERTO</a></strong></code>
<div class="block">Minimum buffer used while sending data to clients.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#offset">offset</a></strong></code>
<div class="block">Current position of read</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#readaheadLength">readaheadLength</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#sentEntireByteRange">sentEntireByteRange</a></strong></code>
<div class="block">Set to true once entire requested byte range has been sent to the client</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#seqno">seqno</a></strong></code>
<div class="block">Sequence number of packet being sent</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#TRANSFERTO_BUFFER_SIZE">TRANSFERTO_BUFFER_SIZE</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#transferToAllowed">transferToAllowed</a></strong></code>
<div class="block">Set to true if transferTo is allowed for sending data to the client</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#verifyChecksum">verifyChecksum</a></strong></code>
<div class="block">When true, verify checksum while reading from checksum file</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/FsVolumeReference.html" title="interface in org.apache.hadoop.hdfs.server.datanode.fsdataset">FsVolumeReference</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#volumeRef">volumeRef</a></strong></code>
<div class="block">The reference to the volume where the block is located</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#BlockSender(org.apache.hadoop.hdfs.protocol.ExtendedBlock,%20long,%20long,%20boolean,%20boolean,%20boolean,%20org.apache.hadoop.hdfs.server.datanode.DataNode,%20java.lang.String,%20org.apache.hadoop.hdfs.server.datanode.CachingStrategy)">BlockSender</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                      long&nbsp;startOffset,
                      long&nbsp;length,
                      boolean&nbsp;corruptChecksumOk,
                      boolean&nbsp;verifyChecksum,
                      boolean&nbsp;sendChecksum,
                      <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/DataNode.html" title="class in org.apache.hadoop.hdfs.server.datanode">DataNode</a>&nbsp;datanode,
                      <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;clientTraceFmt,
                      <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/CachingStrategy.html" title="class in org.apache.hadoop.hdfs.server.datanode">CachingStrategy</a>&nbsp;cachingStrategy)</code>
<div class="block">Constructor</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#close()">close</a></strong>()</code>
<div class="block">close opened files.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#didSendEntireByteRange()">didSendEntireByteRange</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#doSendBlock(java.io.DataOutputStream,%20java.io.OutputStream,%20org.apache.hadoop.hdfs.util.DataTransferThrottler)">doSendBlock</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html?is-external=true" title="class or interface in java.io">DataOutputStream</a>&nbsp;out,
                      <a href="https://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;baseStream,
                      <a href="../../../../../../org/apache/hadoop/hdfs/util/DataTransferThrottler.html" title="class in org.apache.hadoop.hdfs.util">DataTransferThrottler</a>&nbsp;throttler)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) org.apache.hadoop.util.DataChecksum</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#getChecksum()">getChecksum</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#getOffset()">getOffset</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/Replica.html" title="interface in org.apache.hadoop.hdfs.server.datanode">Replica</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#getReplica(org.apache.hadoop.hdfs.protocol.ExtendedBlock,%20org.apache.hadoop.hdfs.server.datanode.DataNode)">getReplica</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                    <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/DataNode.html" title="class in org.apache.hadoop.hdfs.server.datanode">DataNode</a>&nbsp;datanode)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#ioeToSocketException(java.io.IOException)">ioeToSocketException</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>&nbsp;ioe)</code>
<div class="block">Converts an IOExcpetion (not subclasses) to SocketException.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#isLongRead()">isLongRead</a></strong>()</code>
<div class="block">Returns true if we have done a long enough read for this block to qualify
 for the DataNode-wide cache management defaults.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#manageOsCache()">manageOsCache</a></strong>()</code>
<div class="block">Manage the OS buffer cache by performing read-ahead
 and drop-behind.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#numberOfChunks(long)">numberOfChunks</a></strong>(long&nbsp;datalen)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#readChecksum(byte[],%20int,%20int)">readChecksum</a></strong>(byte[]&nbsp;buf,
                        int&nbsp;checksumOffset,
                        int&nbsp;checksumLen)</code>
<div class="block">Read checksum into given buffer</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#sendBlock(java.io.DataOutputStream,%20java.io.OutputStream,%20org.apache.hadoop.hdfs.util.DataTransferThrottler)">sendBlock</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html?is-external=true" title="class or interface in java.io">DataOutputStream</a>&nbsp;out,
                  <a href="https://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;baseStream,
                  <a href="../../../../../../org/apache/hadoop/hdfs/util/DataTransferThrottler.html" title="class in org.apache.hadoop.hdfs.util">DataTransferThrottler</a>&nbsp;throttler)</code>
<div class="block">sendBlock() is used to read block and its metadata and stream the data to
 either a client or to another datanode.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#sendPacket(java.nio.ByteBuffer,%20int,%20java.io.OutputStream,%20boolean,%20org.apache.hadoop.hdfs.util.DataTransferThrottler)">sendPacket</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;pkt,
                    int&nbsp;maxChunks,
                    <a href="https://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;out,
                    boolean&nbsp;transferTo,
                    <a href="../../../../../../org/apache/hadoop/hdfs/util/DataTransferThrottler.html" title="class in org.apache.hadoop.hdfs.util">DataTransferThrottler</a>&nbsp;throttler)</code>
<div class="block">Sends a packet with up to maxChunks chunks of data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#verifyChecksum(byte[],%20int,%20int,%20int,%20int)">verifyChecksum</a></strong>(byte[]&nbsp;buf,
                            int&nbsp;dataOffset,
                            int&nbsp;datalen,
                            int&nbsp;numChunks,
                            int&nbsp;checksumOffset)</code>
<div class="block">Compute checksum for chunks and verify the checksum that is read from
 the metadata file is correct.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#waitForMinLength(org.apache.hadoop.hdfs.server.datanode.ReplicaBeingWritten,%20long)">waitForMinLength</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaBeingWritten.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaBeingWritten</a>&nbsp;rbw,
                                long&nbsp;len)</code>
<div class="block">Wait for rbw replica to reach the length</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#writePacketHeader(java.nio.ByteBuffer,%20int,%20int)">writePacketHeader</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;pkt,
                                  int&nbsp;dataLen,
                                  int&nbsp;packetLen)</code>
<div class="block">Write packet header into <code>pkt</code>,
 return the length of the header written.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="LOG">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOG</h4>
<pre>static final&nbsp;org.apache.commons.logging.Log <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.97">LOG</a></pre>
</li>
</ul>
<a name="ClientTraceLog">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ClientTraceLog</h4>
<pre>static final&nbsp;org.apache.commons.logging.Log <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.98">ClientTraceLog</a></pre>
</li>
</ul>
<a name="is32Bit">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>is32Bit</h4>
<pre>private static final&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.99">is32Bit</a></pre>
</li>
</ul>
<a name="MIN_BUFFER_WITH_TRANSFERTO">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MIN_BUFFER_WITH_TRANSFERTO</h4>
<pre>private static final&nbsp;int <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.106">MIN_BUFFER_WITH_TRANSFERTO</a></pre>
<div class="block">Minimum buffer used while sending data to clients. Used only if
 transferTo() is enabled. 64KB is not that large. It could be larger, but
 not sure if there will be much more improvement.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../constant-values.html#org.apache.hadoop.hdfs.server.datanode.BlockSender.MIN_BUFFER_WITH_TRANSFERTO">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="TRANSFERTO_BUFFER_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TRANSFERTO_BUFFER_SIZE</h4>
<pre>private static final&nbsp;int <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.107">TRANSFERTO_BUFFER_SIZE</a></pre>
</li>
</ul>
<a name="block">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>block</h4>
<pre>private final&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.111">block</a></pre>
<div class="block">the block to read from</div>
</li>
</ul>
<a name="blockIn">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>blockIn</h4>
<pre>private&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io">InputStream</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.113">blockIn</a></pre>
<div class="block">Stream to read block data from</div>
</li>
</ul>
<a name="blockInPosition">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>blockInPosition</h4>
<pre>private&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.115">blockInPosition</a></pre>
<div class="block">updated while using transferTo()</div>
</li>
</ul>
<a name="checksumIn">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checksumIn</h4>
<pre>private&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html?is-external=true" title="class or interface in java.io">DataInputStream</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.117">checksumIn</a></pre>
<div class="block">Stream to read checksum</div>
</li>
</ul>
<a name="checksum">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checksum</h4>
<pre>private final&nbsp;org.apache.hadoop.util.DataChecksum <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.119">checksum</a></pre>
<div class="block">Checksum utility</div>
</li>
</ul>
<a name="initialOffset">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialOffset</h4>
<pre>private&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.121">initialOffset</a></pre>
<div class="block">Initial position to read</div>
</li>
</ul>
<a name="offset">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>offset</h4>
<pre>private&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.123">offset</a></pre>
<div class="block">Current position of read</div>
</li>
</ul>
<a name="endOffset">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>endOffset</h4>
<pre>private final&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.125">endOffset</a></pre>
<div class="block">Position of last byte to read from block file</div>
</li>
</ul>
<a name="chunkSize">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>chunkSize</h4>
<pre>private final&nbsp;int <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.127">chunkSize</a></pre>
<div class="block">Number of bytes in chunk used for computing checksum</div>
</li>
</ul>
<a name="checksumSize">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checksumSize</h4>
<pre>private final&nbsp;int <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.129">checksumSize</a></pre>
<div class="block">Number bytes of checksum computed for a chunk</div>
</li>
</ul>
<a name="corruptChecksumOk">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>corruptChecksumOk</h4>
<pre>private final&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.131">corruptChecksumOk</a></pre>
<div class="block">If true, failure to read checksum is ignored</div>
</li>
</ul>
<a name="seqno">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>seqno</h4>
<pre>private&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.133">seqno</a></pre>
<div class="block">Sequence number of packet being sent</div>
</li>
</ul>
<a name="transferToAllowed">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>transferToAllowed</h4>
<pre>private final&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.135">transferToAllowed</a></pre>
<div class="block">Set to true if transferTo is allowed for sending data to the client</div>
</li>
</ul>
<a name="sentEntireByteRange">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sentEntireByteRange</h4>
<pre>private&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.137">sentEntireByteRange</a></pre>
<div class="block">Set to true once entire requested byte range has been sent to the client</div>
</li>
</ul>
<a name="verifyChecksum">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyChecksum</h4>
<pre>private final&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.139">verifyChecksum</a></pre>
<div class="block">When true, verify checksum while reading from checksum file</div>
</li>
</ul>
<a name="clientTraceFmt">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clientTraceFmt</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.141">clientTraceFmt</a></pre>
<div class="block">Format used to print client trace log messages</div>
</li>
</ul>
<a name="lastChunkChecksum">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastChunkChecksum</h4>
<pre>private volatile&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/ChunkChecksum.html" title="class in org.apache.hadoop.hdfs.server.datanode">ChunkChecksum</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.142">lastChunkChecksum</a></pre>
</li>
</ul>
<a name="datanode">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>datanode</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/DataNode.html" title="class in org.apache.hadoop.hdfs.server.datanode">DataNode</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.143">datanode</a></pre>
</li>
</ul>
<a name="blockInFd">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>blockInFd</h4>
<pre>private&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/FileDescriptor.html?is-external=true" title="class or interface in java.io">FileDescriptor</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.146">blockInFd</a></pre>
<div class="block">The file descriptor of the block being sent</div>
</li>
</ul>
<a name="volumeRef">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>volumeRef</h4>
<pre>private&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/FsVolumeReference.html" title="interface in org.apache.hadoop.hdfs.server.datanode.fsdataset">FsVolumeReference</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.148">volumeRef</a></pre>
<div class="block">The reference to the volume where the block is located</div>
</li>
</ul>
<a name="readaheadLength">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readaheadLength</h4>
<pre>private final&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.151">readaheadLength</a></pre>
</li>
</ul>
<a name="curReadahead">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>curReadahead</h4>
<pre>private&nbsp;org.apache.hadoop.io.ReadaheadPool.ReadaheadRequest <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.153">curReadahead</a></pre>
</li>
</ul>
<a name="alwaysReadahead">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>alwaysReadahead</h4>
<pre>private final&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.155">alwaysReadahead</a></pre>
</li>
</ul>
<a name="dropCacheBehindLargeReads">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dropCacheBehindLargeReads</h4>
<pre>private final&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.157">dropCacheBehindLargeReads</a></pre>
</li>
</ul>
<a name="dropCacheBehindAllReads">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dropCacheBehindAllReads</h4>
<pre>private final&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.159">dropCacheBehindAllReads</a></pre>
</li>
</ul>
<a name="lastCacheDropOffset">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastCacheDropOffset</h4>
<pre>private&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.161">lastCacheDropOffset</a></pre>
</li>
</ul>
<a name="CACHE_DROP_INTERVAL_BYTES">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CACHE_DROP_INTERVAL_BYTES</h4>
<pre>static&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.164">CACHE_DROP_INTERVAL_BYTES</a></pre>
</li>
</ul>
<a name="LONG_READ_THRESHOLD_BYTES">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>LONG_READ_THRESHOLD_BYTES</h4>
<pre>private static final&nbsp;long <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.169">LONG_READ_THRESHOLD_BYTES</a></pre>
<div class="block">See {<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockSender.html#isLongRead()"><code>isLongRead()</code></a></div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../constant-values.html#org.apache.hadoop.hdfs.server.datanode.BlockSender.LONG_READ_THRESHOLD_BYTES">Constant Field Values</a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BlockSender(org.apache.hadoop.hdfs.protocol.ExtendedBlock, long, long, boolean, boolean, boolean, org.apache.hadoop.hdfs.server.datanode.DataNode, java.lang.String, org.apache.hadoop.hdfs.server.datanode.CachingStrategy)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BlockSender</h4>
<pre><a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.185">BlockSender</a>(<a href="../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
           long&nbsp;startOffset,
           long&nbsp;length,
           boolean&nbsp;corruptChecksumOk,
           boolean&nbsp;verifyChecksum,
           boolean&nbsp;sendChecksum,
           <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/DataNode.html" title="class in org.apache.hadoop.hdfs.server.datanode">DataNode</a>&nbsp;datanode,
           <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;clientTraceFmt,
           <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/CachingStrategy.html" title="class in org.apache.hadoop.hdfs.server.datanode">CachingStrategy</a>&nbsp;cachingStrategy)
      throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Constructor</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>block</code> - Block that is being read</dd><dd><code>startOffset</code> - starting offset to read from</dd><dd><code>length</code> - length of data to read</dd><dd><code>corruptChecksumOk</code> - if true, corrupt checksum is okay</dd><dd><code>verifyChecksum</code> - verify checksum while reading the data</dd><dd><code>sendChecksum</code> - send checksum to client.</dd><dd><code>datanode</code> - datanode from which the block is being read</dd><dd><code>clientTraceFmt</code> - format string used to print client trace logs</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.401">close</a>()
           throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">close opened files.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html?is-external=true#close()" title="class or interface in java.io">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html?is-external=true" title="class or interface in java.io">Closeable</a></code></dd>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/AutoCloseable.html?is-external=true#close()" title="class or interface in java.lang">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang">AutoCloseable</a></code></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="getReplica(org.apache.hadoop.hdfs.protocol.ExtendedBlock, org.apache.hadoop.hdfs.server.datanode.DataNode)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getReplica</h4>
<pre>private static&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/Replica.html" title="interface in org.apache.hadoop.hdfs.server.datanode">Replica</a>&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.446">getReplica</a>(<a href="../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                 <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/DataNode.html" title="class in org.apache.hadoop.hdfs.server.datanode">DataNode</a>&nbsp;datanode)
                           throws <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaNotFoundException.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaNotFoundException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaNotFoundException.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaNotFoundException</a></code></dd></dl>
</li>
</ul>
<a name="waitForMinLength(org.apache.hadoop.hdfs.server.datanode.ReplicaBeingWritten, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>waitForMinLength</h4>
<pre>private static&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.462">waitForMinLength</a>(<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaBeingWritten.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaBeingWritten</a>&nbsp;rbw,
                    long&nbsp;len)
                              throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Wait for rbw replica to reach the length</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>rbw</code> - replica that is being written to</dd><dd><code>len</code> - minimum length to reach</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - on failing to reach the len in given wait time</dd></dl>
</li>
</ul>
<a name="ioeToSocketException(java.io.IOException)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ioeToSocketException</h4>
<pre>private static&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.486">ioeToSocketException</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>&nbsp;ioe)</pre>
<div class="block">Converts an IOExcpetion (not subclasses) to SocketException.
 This is typically done to indicate to upper layers that the error 
 was a socket error rather than often more serious exceptions like 
 disk errors.</div>
</li>
</ul>
<a name="numberOfChunks(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>numberOfChunks</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.504">numberOfChunks</a>(long&nbsp;datalen)</pre>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>datalen</code> - Length of data</dd>
<dt><span class="strong">Returns:</span></dt><dd>number of chunks for data of given size</dd></dl>
</li>
</ul>
<a name="sendPacket(java.nio.ByteBuffer, int, java.io.OutputStream, boolean, org.apache.hadoop.hdfs.util.DataTransferThrottler)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendPacket</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.517">sendPacket</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;pkt,
             int&nbsp;maxChunks,
             <a href="https://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;out,
             boolean&nbsp;transferTo,
             <a href="../../../../../../org/apache/hadoop/hdfs/util/DataTransferThrottler.html" title="class in org.apache.hadoop.hdfs.util">DataTransferThrottler</a>&nbsp;throttler)
                throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Sends a packet with up to maxChunks chunks of data.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>pkt</code> - buffer used for writing packet data</dd><dd><code>maxChunks</code> - maximum number of chunks to send</dd><dd><code>out</code> - stream to send data to</dd><dd><code>transferTo</code> - use transferTo to send data</dd><dd><code>throttler</code> - used for throttling data transfer bandwidth</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="readChecksum(byte[], int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readChecksum</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.632">readChecksum</a>(byte[]&nbsp;buf,
                int&nbsp;checksumOffset,
                int&nbsp;checksumLen)
                   throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Read checksum into given buffer</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>buf</code> - buffer to read the checksum into</dd><dd><code>checksumOffset</code> - offset at which to write the checksum into buf</dd><dd><code>checksumLen</code> - length of checksum to write</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - on error</dd></dl>
</li>
</ul>
<a name="verifyChecksum(byte[], int, int, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifyChecksum</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.666">verifyChecksum</a>(byte[]&nbsp;buf,
                  int&nbsp;dataOffset,
                  int&nbsp;datalen,
                  int&nbsp;numChunks,
                  int&nbsp;checksumOffset)
                    throws org.apache.hadoop.fs.ChecksumException</pre>
<div class="block">Compute checksum for chunks and verify the checksum that is read from
 the metadata file is correct.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>buf</code> - buffer that has checksum and data</dd><dd><code>dataOffset</code> - position where data is written in the buf</dd><dd><code>datalen</code> - length of data</dd><dd><code>numChunks</code> - number of chunks corresponding to data</dd><dd><code>checksumOffset</code> - offset where checksum is written in the buf</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>org.apache.hadoop.fs.ChecksumException</code> - on failed checksum verification</dd></dl>
</li>
</ul>
<a name="sendBlock(java.io.DataOutputStream, java.io.OutputStream, org.apache.hadoop.hdfs.util.DataTransferThrottler)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendBlock</h4>
<pre>long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.701">sendBlock</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html?is-external=true" title="class or interface in java.io">DataOutputStream</a>&nbsp;out,
             <a href="https://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;baseStream,
             <a href="../../../../../../org/apache/hadoop/hdfs/util/DataTransferThrottler.html" title="class in org.apache.hadoop.hdfs.util">DataTransferThrottler</a>&nbsp;throttler)
         throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">sendBlock() is used to read block and its metadata and stream the data to
 either a client or to another datanode.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>out</code> - stream to which the block is written to</dd><dd><code>baseStream</code> - optional. if non-null, <code>out</code> is assumed to 
        be a wrapper over this stream. This enables optimizations for
        sending the data, e.g. 
        <code>SocketOutputStream.transferToFully(FileChannel, 
        long, int)</code>.</dd><dd><code>throttler</code> - for sending data.</dd>
<dt><span class="strong">Returns:</span></dt><dd>total bytes read, including checksum data.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="doSendBlock(java.io.DataOutputStream, java.io.OutputStream, org.apache.hadoop.hdfs.util.DataTransferThrottler)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doSendBlock</h4>
<pre>private&nbsp;long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.712">doSendBlock</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html?is-external=true" title="class or interface in java.io">DataOutputStream</a>&nbsp;out,
               <a href="https://docs.oracle.com/javase/7/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io">OutputStream</a>&nbsp;baseStream,
               <a href="../../../../../../org/apache/hadoop/hdfs/util/DataTransferThrottler.html" title="class in org.apache.hadoop.hdfs.util">DataTransferThrottler</a>&nbsp;throttler)
                  throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="manageOsCache()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>manageOsCache</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.793">manageOsCache</a>()
                    throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Manage the OS buffer cache by performing read-ahead
 and drop-behind.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="isLongRead()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isLongRead</h4>
<pre>private&nbsp;boolean&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.833">isLongRead</a>()</pre>
<div class="block">Returns true if we have done a long enough read for this block to qualify
 for the DataNode-wide cache management defaults.  We avoid applying the
 cache management defaults to smaller reads because the overhead would be
 too high.

 Note that if the client explicitly asked for dropBehind, we will do it
 even on short reads.
 
 This is also used to determine when to invoke
 posix_fadvise(POSIX_FADV_SEQUENTIAL).</div>
</li>
</ul>
<a name="writePacketHeader(java.nio.ByteBuffer, int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writePacketHeader</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.841">writePacketHeader</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html?is-external=true" title="class or interface in java.nio">ByteBuffer</a>&nbsp;pkt,
                    int&nbsp;dataLen,
                    int&nbsp;packetLen)</pre>
<div class="block">Write packet header into <code>pkt</code>,
 return the length of the header written.</div>
</li>
</ul>
<a name="didSendEntireByteRange()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>didSendEntireByteRange</h4>
<pre>boolean&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.853">didSendEntireByteRange</a>()</pre>
</li>
</ul>
<a name="getChecksum()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getChecksum</h4>
<pre>org.apache.hadoop.util.DataChecksum&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.860">getChecksum</a>()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd>the checksum type that will be used with this block transfer.</dd></dl>
</li>
</ul>
<a name="getOffset()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getOffset</h4>
<pre>long&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockSender.html#line.868">getOffset</a>()</pre>
<dl><dt><span class="strong">Returns:</span></dt><dd>the offset into the block file where the sender is currently
 reading.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockSender.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockScanner.Servlet.html" title="class in org.apache.hadoop.hdfs.server.datanode"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BPOfferService.html" title="class in org.apache.hadoop.hdfs.server.datanode"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hdfs/server/datanode/BlockSender.html" target="_top">Frames</a></li>
<li><a href="BlockSender.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
