<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Wed Jun 10 23:54:06 EDT 2015 -->
<title>BlockReceiver.PacketResponder</title>
<meta name="date" content="2015-06-10">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BlockReceiver.PacketResponder";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockReceiver.PacketResponder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.Packet.html" title="class in org.apache.hadoop.hdfs.server.datanode"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponderType.html" title="enum in org.apache.hadoop.hdfs.server.datanode"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html" target="_top">Frames</a></li>
<li><a href="BlockReceiver.PacketResponder.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.hadoop.hdfs.server.datanode</div>
<h2 title="Class BlockReceiver.PacketResponder" class="title">Class BlockReceiver.PacketResponder</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.hadoop.hdfs.server.datanode.BlockReceiver.PacketResponder</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="https://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html?is-external=true" title="class or interface in java.io">Closeable</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang">AutoCloseable</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang">Runnable</a></dd>
</dl>
<dl>
<dt>Enclosing class:</dt>
<dd><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.html" title="class in org.apache.hadoop.hdfs.server.datanode">BlockReceiver</a></dd>
</dl>
<hr>
<br>
<pre> class <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.html#line.1003">BlockReceiver.PacketResponder</a>
extends <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang">Runnable</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html?is-external=true" title="class or interface in java.io">Closeable</a></pre>
<div class="block">Processes responses from downstream datanodes in the pipeline
 and sends back replies to the originator.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/util/LinkedList.html?is-external=true" title="class or interface in java.util">LinkedList</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.Packet.html" title="class in org.apache.hadoop.hdfs.server.datanode">BlockReceiver.Packet</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#ackQueue">ackQueue</a></strong></code>
<div class="block">queue for packets waiting for ack - synchronization using monitor lock</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html?is-external=true" title="class or interface in java.io">DataInputStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#downstreamIn">downstreamIn</a></strong></code>
<div class="block">input from the next downstream datanode</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#myString">myString</a></strong></code>
<div class="block">for log and error messages</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html?is-external=true" title="class or interface in java.lang">Thread</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#receiverThread">receiverThread</a></strong></code>
<div class="block">the thread that spawns this responder</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#running">running</a></strong></code>
<div class="block">is this responder running? - synchronization using monitor lock</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#sending">sending</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponderType.html" title="enum in org.apache.hadoop.hdfs.server.datanode">BlockReceiver.PacketResponderType</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#type">type</a></strong></code>
<div class="block">The type of this responder</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html?is-external=true" title="class or interface in java.io">DataOutputStream</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#upstreamOut">upstreamOut</a></strong></code>
<div class="block">output to upstream datanode/client</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#BlockReceiver.PacketResponder(java.io.DataOutputStream,%20java.io.DataInputStream,%20org.apache.hadoop.hdfs.protocol.DatanodeInfo[])">BlockReceiver.PacketResponder</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html?is-external=true" title="class or interface in java.io">DataOutputStream</a>&nbsp;upstreamOut,
                                                          <a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html?is-external=true" title="class or interface in java.io">DataInputStream</a>&nbsp;downstreamIn,
                                                          <a href="../../../../../../org/apache/hadoop/hdfs/protocol/DatanodeInfo.html" title="class in org.apache.hadoop.hdfs.protocol">DatanodeInfo</a>[]&nbsp;downstreams)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#close()">close</a></strong>()</code>
<div class="block">wait for all pending packets to be acked.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#enqueue(long,%20boolean,%20long,%20org.apache.hadoop.hdfs.protocol.proto.DataTransferProtos.Status)">enqueue</a></strong>(long&nbsp;seqno,
              boolean&nbsp;lastPacketInBlock,
              long&nbsp;offsetInBlock,
              org.apache.hadoop.hdfs.protocol.proto.DataTransferProtos.Status&nbsp;ackStatus)</code>
<div class="block">enqueue the seqno that is still be to acked by the downstream datanode.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#finalizeBlock(long)">finalizeBlock</a></strong>(long&nbsp;startTime)</code>
<div class="block">Finalize the block and close the block file</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#isRunning()">isRunning</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#removeAckHead()">removeAckHead</a></strong>()</code>
<div class="block">Remove a packet from the head of the ack queue
 
 This should be called only when the ack queue is not empty</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#run()">run</a></strong>()</code>
<div class="block">Thread to process incoming acks.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#sendAckUpstream(org.apache.hadoop.hdfs.protocol.datatransfer.PipelineAck,%20long,%20long,%20long,%20int)">sendAckUpstream</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/protocol/datatransfer/PipelineAck.html" title="class in org.apache.hadoop.hdfs.protocol.datatransfer">PipelineAck</a>&nbsp;ack,
                              long&nbsp;seqno,
                              long&nbsp;totalAckTimeNanos,
                              long&nbsp;offsetInBlock,
                              int&nbsp;myHeader)</code>
<div class="block">The wrapper for the unprotected version.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#sendAckUpstreamUnprotected(org.apache.hadoop.hdfs.protocol.datatransfer.PipelineAck,%20long,%20long,%20long,%20int)">sendAckUpstreamUnprotected</a></strong>(<a href="../../../../../../org/apache/hadoop/hdfs/protocol/datatransfer/PipelineAck.html" title="class in org.apache.hadoop.hdfs.protocol.datatransfer">PipelineAck</a>&nbsp;ack,
                                                    long&nbsp;seqno,
                                                    long&nbsp;totalAckTimeNanos,
                                                    long&nbsp;offsetInBlock,
                                                    int&nbsp;myHeader)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#sendOOBResponse(org.apache.hadoop.hdfs.protocol.proto.DataTransferProtos.Status)">sendOOBResponse</a></strong>(org.apache.hadoop.hdfs.protocol.proto.DataTransferProtos.Status&nbsp;ackStatus)</code>
<div class="block">Send an OOB response.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#toString()">toString</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.Packet.html" title="class in org.apache.hadoop.hdfs.server.datanode">BlockReceiver.Packet</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#waitForAckHead(long)">waitForAckHead</a></strong>(long&nbsp;seqno)</code>
<div class="block">Wait for a packet with given <code>seqno</code> to be enqueued to ackQueue</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="ackQueue">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ackQueue</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/LinkedList.html?is-external=true" title="class or interface in java.util">LinkedList</a>&lt;<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.Packet.html" title="class in org.apache.hadoop.hdfs.server.datanode">BlockReceiver.Packet</a>&gt; <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1005">ackQueue</a></pre>
<div class="block">queue for packets waiting for ack - synchronization using monitor lock</div>
</li>
</ul>
<a name="receiverThread">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>receiverThread</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html?is-external=true" title="class or interface in java.lang">Thread</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1007">receiverThread</a></pre>
<div class="block">the thread that spawns this responder</div>
</li>
</ul>
<a name="running">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>running</h4>
<pre>private volatile&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1009">running</a></pre>
<div class="block">is this responder running? - synchronization using monitor lock</div>
</li>
</ul>
<a name="downstreamIn">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>downstreamIn</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html?is-external=true" title="class or interface in java.io">DataInputStream</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1011">downstreamIn</a></pre>
<div class="block">input from the next downstream datanode</div>
</li>
</ul>
<a name="upstreamOut">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>upstreamOut</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html?is-external=true" title="class or interface in java.io">DataOutputStream</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1013">upstreamOut</a></pre>
<div class="block">output to upstream datanode/client</div>
</li>
</ul>
<a name="type">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>type</h4>
<pre>private final&nbsp;<a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponderType.html" title="enum in org.apache.hadoop.hdfs.server.datanode">BlockReceiver.PacketResponderType</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1015">type</a></pre>
<div class="block">The type of this responder</div>
</li>
</ul>
<a name="myString">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>myString</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1017">myString</a></pre>
<div class="block">for log and error messages</div>
</li>
</ul>
<a name="sending">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>sending</h4>
<pre>private&nbsp;boolean <a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1018">sending</a></pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BlockReceiver.PacketResponder(java.io.DataOutputStream, java.io.DataInputStream, org.apache.hadoop.hdfs.protocol.DatanodeInfo[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BlockReceiver.PacketResponder</h4>
<pre><a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1025">BlockReceiver.PacketResponder</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataOutputStream.html?is-external=true" title="class or interface in java.io">DataOutputStream</a>&nbsp;upstreamOut,
                             <a href="https://docs.oracle.com/javase/7/docs/api/java/io/DataInputStream.html?is-external=true" title="class or interface in java.io">DataInputStream</a>&nbsp;downstreamIn,
                             <a href="../../../../../../org/apache/hadoop/hdfs/protocol/DatanodeInfo.html" title="class in org.apache.hadoop.hdfs.protocol">DatanodeInfo</a>[]&nbsp;downstreams)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1021">toString</a>()</pre>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
</dl>
</li>
</ul>
<a name="isRunning()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isRunning</h4>
<pre>private&nbsp;boolean&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1043">isRunning</a>()</pre>
</li>
</ul>
<a name="enqueue(long, boolean, long, org.apache.hadoop.hdfs.protocol.proto.DataTransferProtos.Status)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>enqueue</h4>
<pre>void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1055">enqueue</a>(long&nbsp;seqno,
           boolean&nbsp;lastPacketInBlock,
           long&nbsp;offsetInBlock,
           org.apache.hadoop.hdfs.protocol.proto.DataTransferProtos.Status&nbsp;ackStatus)</pre>
<div class="block">enqueue the seqno that is still be to acked by the downstream datanode.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>seqno</code> - sequence number of the packet</dd><dd><code>lastPacketInBlock</code> - if true, this is the last packet in block</dd><dd><code>offsetInBlock</code> - offset of this packet in block</dd></dl>
</li>
</ul>
<a name="sendOOBResponse(org.apache.hadoop.hdfs.protocol.proto.DataTransferProtos.Status)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendOOBResponse</h4>
<pre>void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1079">sendOOBResponse</a>(org.apache.hadoop.hdfs.protocol.proto.DataTransferProtos.Status&nbsp;ackStatus)
               throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a>,
                      <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Send an OOB response. If all acks have been sent already for the block
 and the responder is about to close, the delivery is not guaranteed.
 This is because the other end can close the connection independently.
 An OOB coming from downstream will be automatically relayed upstream
 by the responder. This method is used only by originating datanode.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>ackStatus</code> - the type of ack to be sent</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="waitForAckHead(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>waitForAckHead</h4>
<pre><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.Packet.html" title="class in org.apache.hadoop.hdfs.server.datanode">BlockReceiver.Packet</a>&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1115">waitForAckHead</a>(long&nbsp;seqno)
                              throws <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></pre>
<div class="block">Wait for a packet with given <code>seqno</code> to be enqueued to ackQueue</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/InterruptedException.html?is-external=true" title="class or interface in java.lang">InterruptedException</a></code></dd></dl>
</li>
</ul>
<a name="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1132">close</a>()</pre>
<div class="block">wait for all pending packets to be acked. Then shutdown thread.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html?is-external=true#close()" title="class or interface in java.io">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/Closeable.html?is-external=true" title="class or interface in java.io">Closeable</a></code></dd>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/AutoCloseable.html?is-external=true#close()" title="class or interface in java.lang">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang">AutoCloseable</a></code></dd>
</dl>
</li>
</ul>
<a name="run()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1160">run</a>()</pre>
<div class="block">Thread to process incoming acks.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html?is-external=true#run()" title="class or interface in java.lang">run</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html?is-external=true" title="class or interface in java.lang">Runnable</a></code></dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html?is-external=true#run()" title="class or interface in java.lang"><code>Runnable.run()</code></a></dd></dl>
</li>
</ul>
<a name="finalizeBlock(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>finalizeBlock</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1293">finalizeBlock</a>(long&nbsp;startTime)
                    throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Finalize the block and close the block file</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>startTime</code> - time when BlockReceiver started receiving the block</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="sendAckUpstream(org.apache.hadoop.hdfs.protocol.datatransfer.PipelineAck, long, long, long, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendAckUpstream</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1333">sendAckUpstream</a>(<a href="../../../../../../org/apache/hadoop/hdfs/protocol/datatransfer/PipelineAck.html" title="class in org.apache.hadoop.hdfs.protocol.datatransfer">PipelineAck</a>&nbsp;ack,
                   long&nbsp;seqno,
                   long&nbsp;totalAckTimeNanos,
                   long&nbsp;offsetInBlock,
                   int&nbsp;myHeader)
                      throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">The wrapper for the unprotected version. This is only called by
 the responder's run() method.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>ack</code> - Ack received from downstream</dd><dd><code>seqno</code> - sequence number of ack to be sent upstream</dd><dd><code>totalAckTimeNanos</code> - total ack time including all the downstream
          nodes</dd><dd><code>offsetInBlock</code> - offset in block for the data in packet</dd><dd><code>myHeader</code> - the local ack header</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="sendAckUpstreamUnprotected(org.apache.hadoop.hdfs.protocol.datatransfer.PipelineAck, long, long, long, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendAckUpstreamUnprotected</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1371">sendAckUpstreamUnprotected</a>(<a href="../../../../../../org/apache/hadoop/hdfs/protocol/datatransfer/PipelineAck.html" title="class in org.apache.hadoop.hdfs.protocol.datatransfer">PipelineAck</a>&nbsp;ack,
                              long&nbsp;seqno,
                              long&nbsp;totalAckTimeNanos,
                              long&nbsp;offsetInBlock,
                              int&nbsp;myHeader)
                                 throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>ack</code> - Ack received from downstream</dd><dd><code>seqno</code> - sequence number of ack to be sent upstream</dd><dd><code>totalAckTimeNanos</code> - total ack time including all the downstream
          nodes</dd><dd><code>offsetInBlock</code> - offset in block for the data in packet</dd><dd><code>myHeader</code> - the local ack header</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="removeAckHead()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>removeAckHead</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html#line.1436">removeAckHead</a>()</pre>
<div class="block">Remove a packet from the head of the ack queue
 
 This should be called only when the ack queue is not empty</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockReceiver.PacketResponder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.Packet.html" title="class in org.apache.hadoop.hdfs.server.datanode"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponderType.html" title="enum in org.apache.hadoop.hdfs.server.datanode"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hdfs/server/datanode/BlockReceiver.PacketResponder.html" target="_top">Frames</a></li>
<li><a href="BlockReceiver.PacketResponder.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
