<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Wed Jun 10 23:53:34 EDT 2015 -->
<title>BlockPoolSlice</title>
<meta name="date" content="2015-06-10">
<link rel="stylesheet" type="text/css" href="../../../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BlockPoolSlice";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockPoolSlice.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsDatasetAsyncDiskService.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../../index.html?org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html" target="_top">Frames</a></li>
<li><a href="BlockPoolSlice.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.hadoop.hdfs.server.datanode.fsdataset.impl</div>
<h2 title="Class BlockPoolSlice" class="title">Class BlockPoolSlice</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.BlockPoolSlice</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre> class <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.65">BlockPoolSlice</a>
extends <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">A block pool slice represents a portion of a block pool stored on a volume.  
 Taken together, all BlockPoolSlices sharing a block pool ID across a 
 cluster represent a single block pool.
 
 This class is synchronized by <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeImpl.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl"><code>FsVolumeImpl</code></a>.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#bpid">bpid</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#currentDir">currentDir</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#deleteDuplicateReplicas">deleteDuplicateReplicas</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private org.apache.hadoop.fs.DU</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#dfsUsage">dfsUsage</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#dfsUsedSaved">dfsUsedSaved</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#DU_CACHE_FILE">DU_CACHE_FILE</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#finalizedDir">finalizedDir</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#lazypersistDir">lazypersistDir</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) static org.apache.commons.logging.Log</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#LOG">LOG</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#rbwDir">rbwDir</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#SHUTDOWN_HOOK_PRIORITY">SHUTDOWN_HOOK_PRIORITY</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#tmpDir">tmpDir</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeImpl.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">FsVolumeImpl</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#volume">volume</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#BlockPoolSlice(java.lang.String,%20org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsVolumeImpl,%20java.io.File,%20org.apache.hadoop.conf.Configuration)">BlockPoolSlice</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;bpid,
                            <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeImpl.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">FsVolumeImpl</a>&nbsp;volume,
                            <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;bpDir,
                            org.apache.hadoop.conf.Configuration&nbsp;conf)</code>
<div class="block">Create a blook pool slice</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#activateSavedReplica(org.apache.hadoop.hdfs.protocol.Block,%20java.io.File,%20java.io.File)">activateSavedReplica</a></strong>(<a href="../../../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;b,
                                        <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;metaFile,
                                        <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;blockFile)</code>
<div class="block">Move a persisted replica from lazypersist directory to a subdirectory
 under finalized.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#addBlock(org.apache.hadoop.hdfs.protocol.Block,%20java.io.File)">addBlock</a></strong>(<a href="../../../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;b,
                <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;f)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#addToReplicasMap(org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.ReplicaMap,%20java.io.File,%20org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.RamDiskReplicaTracker,%20boolean)">addToReplicasMap</a></strong>(<a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/ReplicaMap.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">ReplicaMap</a>&nbsp;volumeMap,
                                <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;dir,
                                <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/RamDiskReplicaTracker.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">RamDiskReplicaTracker</a>&nbsp;lazyWriteReplicaMap,
                                boolean&nbsp;isFinalized)</code>
<div class="block">Add replicas under the given directory to the volume map</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#checkDirs()">checkDirs</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#createRbwFile(org.apache.hadoop.hdfs.protocol.Block)">createRbwFile</a></strong>(<a href="../../../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;b)</code>
<div class="block">RBW files.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#createTmpFile(org.apache.hadoop.hdfs.protocol.Block)">createTmpFile</a></strong>(<a href="../../../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;b)</code>
<div class="block">Temporary files.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#decDfsUsed(long)">decDfsUsed</a></strong>(long&nbsp;value)</code>
<div class="block">Run DU on local drives.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#getDfsUsed()">getDfsUsed</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#getDirectory()">getDirectory</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#getFinalizedDir()">getFinalizedDir</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#getLazypersistDir()">getLazypersistDir</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#getRbwDir()">getRbwDir</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#getTmpDir()">getTmpDir</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#getVolumeMap(org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.ReplicaMap,%20org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.RamDiskReplicaTracker)">getVolumeMap</a></strong>(<a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/ReplicaMap.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">ReplicaMap</a>&nbsp;volumeMap,
                        <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/RamDiskReplicaTracker.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">RamDiskReplicaTracker</a>&nbsp;lazyWriteReplicaMap)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#incDfsUsed(long)">incDfsUsed</a></strong>(long&nbsp;value)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#loadDfsUsed()">loadDfsUsed</a></strong>()</code>
<div class="block">Read in the cached DU value and return it if it is less than 600 seconds
 old (DU update interval).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#moveLazyPersistReplicasToFinalized(java.io.File)">moveLazyPersistReplicasToFinalized</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;source)</code>
<div class="block">Move replicas in the lazy persist directory to their corresponding locations
 in the finalized directory.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#recoverTempUnlinkedBlock(java.io.File)">recoverTempUnlinkedBlock</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;unlinkedTmp)</code>
<div class="block">Recover an unlinked tmp file on datanode restart.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaInfo.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaInfo</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#resolveDuplicateReplicas(org.apache.hadoop.hdfs.server.datanode.ReplicaInfo,%20org.apache.hadoop.hdfs.server.datanode.ReplicaInfo,%20org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.ReplicaMap)">resolveDuplicateReplicas</a></strong>(<a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaInfo.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaInfo</a>&nbsp;replica1,
                                                <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaInfo.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaInfo</a>&nbsp;replica2,
                                                <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/ReplicaMap.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">ReplicaMap</a>&nbsp;volumeMap)</code>
<div class="block">This method is invoked during DN startup when volumes are scanned to
 build up the volumeMap.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#saveDfsUsed()">saveDfsUsed</a></strong>()</code>
<div class="block">Write the current dfsUsed to the cache file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#shutdown()">shutdown</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#toString()">toString</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#validateIntegrityAndSetLength(java.io.File,%20long)">validateIntegrityAndSetLength</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;blockFile,
                                                          long&nbsp;genStamp)</code>
<div class="block">Find out the number of bytes in the block that match its crc.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="LOG">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOG</h4>
<pre>static final&nbsp;org.apache.commons.logging.Log <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.66">LOG</a></pre>
</li>
</ul>
<a name="bpid">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bpid</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.68">bpid</a></pre>
</li>
</ul>
<a name="volume">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>volume</h4>
<pre>private final&nbsp;<a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeImpl.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">FsVolumeImpl</a> <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.69">volume</a></pre>
</li>
</ul>
<a name="currentDir">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>currentDir</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a> <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.70">currentDir</a></pre>
</li>
</ul>
<a name="finalizedDir">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>finalizedDir</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a> <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.72">finalizedDir</a></pre>
</li>
</ul>
<a name="lazypersistDir">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazypersistDir</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a> <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.73">lazypersistDir</a></pre>
</li>
</ul>
<a name="rbwDir">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rbwDir</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a> <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.74">rbwDir</a></pre>
</li>
</ul>
<a name="tmpDir">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tmpDir</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a> <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.75">tmpDir</a></pre>
</li>
</ul>
<a name="DU_CACHE_FILE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DU_CACHE_FILE</h4>
<pre>private static final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.76">DU_CACHE_FILE</a></pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../../../constant-values.html#org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.BlockPoolSlice.DU_CACHE_FILE">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="dfsUsedSaved">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dfsUsedSaved</h4>
<pre>private volatile&nbsp;boolean <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.77">dfsUsedSaved</a></pre>
</li>
</ul>
<a name="SHUTDOWN_HOOK_PRIORITY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SHUTDOWN_HOOK_PRIORITY</h4>
<pre>private static final&nbsp;int <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.78">SHUTDOWN_HOOK_PRIORITY</a></pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../../../constant-values.html#org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.BlockPoolSlice.SHUTDOWN_HOOK_PRIORITY">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="deleteDuplicateReplicas">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteDuplicateReplicas</h4>
<pre>private final&nbsp;boolean <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.79">deleteDuplicateReplicas</a></pre>
</li>
</ul>
<a name="dfsUsage">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>dfsUsage</h4>
<pre>private final&nbsp;org.apache.hadoop.fs.DU <a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.82">dfsUsage</a></pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BlockPoolSlice(java.lang.String, org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.FsVolumeImpl, java.io.File, org.apache.hadoop.conf.Configuration)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BlockPoolSlice</h4>
<pre><a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.92">BlockPoolSlice</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;bpid,
              <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeImpl.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">FsVolumeImpl</a>&nbsp;volume,
              <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;bpDir,
              org.apache.hadoop.conf.Configuration&nbsp;conf)
         throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Create a blook pool slice</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>bpid</code> - Block pool Id</dd><dd><code>volume</code> - <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsVolumeImpl.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl"><code>FsVolumeImpl</code></a> to which this BlockPool belongs to</dd><dd><code>bpDir</code> - directory corresponding to the BlockPool</dd><dd><code>conf</code> - configuration</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getDirectory()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDirectory</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.153">getDirectory</a>()</pre>
</li>
</ul>
<a name="getFinalizedDir()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFinalizedDir</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.157">getFinalizedDir</a>()</pre>
</li>
</ul>
<a name="getLazypersistDir()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLazypersistDir</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.161">getLazypersistDir</a>()</pre>
</li>
</ul>
<a name="getRbwDir()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRbwDir</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.165">getRbwDir</a>()</pre>
</li>
</ul>
<a name="getTmpDir()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTmpDir</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.169">getTmpDir</a>()</pre>
</li>
</ul>
<a name="decDfsUsed(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decDfsUsed</h4>
<pre>void&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.174">decDfsUsed</a>(long&nbsp;value)</pre>
<div class="block">Run DU on local drives.  It must be synchronized from caller.</div>
</li>
</ul>
<a name="getDfsUsed()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDfsUsed</h4>
<pre>long&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.178">getDfsUsed</a>()
          throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="incDfsUsed(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>incDfsUsed</h4>
<pre>void&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.182">incDfsUsed</a>(long&nbsp;value)</pre>
</li>
</ul>
<a name="loadDfsUsed()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadDfsUsed</h4>
<pre>long&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.192">loadDfsUsed</a>()</pre>
<div class="block">Read in the cached DU value and return it if it is less than 600 seconds
 old (DU update interval). Slight imprecision of dfsUsed is not critical
 and skipping DU can significantly shorten the startup time.
 If the cached value is not available or too old, -1 is returned.</div>
</li>
</ul>
<a name="saveDfsUsed()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveDfsUsed</h4>
<pre>void&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.232">saveDfsUsed</a>()</pre>
<div class="block">Write the current dfsUsed to the cache file.</div>
</li>
</ul>
<a name="createTmpFile(org.apache.hadoop.hdfs.protocol.Block)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createTmpFile</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.258">createTmpFile</a>(<a href="../../../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;b)
             throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Temporary files. They get moved to the finalized block directory when
 the block is finalized.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="createRbwFile(org.apache.hadoop.hdfs.protocol.Block)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createRbwFile</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.267">createRbwFile</a>(<a href="../../../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;b)
             throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">RBW files. They get moved to the finalized block directory when
 the block is finalized.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="addBlock(org.apache.hadoop.hdfs.protocol.Block, java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addBlock</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.272">addBlock</a>(<a href="../../../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;b,
            <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;f)
        throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="activateSavedReplica(org.apache.hadoop.hdfs.protocol.Block, java.io.File, java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>activateSavedReplica</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.289">activateSavedReplica</a>(<a href="../../../../../../../../org/apache/hadoop/hdfs/protocol/Block.html" title="class in org.apache.hadoop.hdfs.protocol">Block</a>&nbsp;b,
                        <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;metaFile,
                        <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;blockFile)
                    throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Move a persisted replica from lazypersist directory to a subdirectory
 under finalized.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="checkDirs()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkDirs</h4>
<pre>void&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.301">checkDirs</a>()
         throws org.apache.hadoop.util.DiskChecker.DiskErrorException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>org.apache.hadoop.util.DiskChecker.DiskErrorException</code></dd></dl>
</li>
</ul>
<a name="getVolumeMap(org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.ReplicaMap, org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.RamDiskReplicaTracker)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVolumeMap</h4>
<pre>void&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.309">getVolumeMap</a>(<a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/ReplicaMap.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">ReplicaMap</a>&nbsp;volumeMap,
                <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/RamDiskReplicaTracker.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">RamDiskReplicaTracker</a>&nbsp;lazyWriteReplicaMap)
            throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="recoverTempUnlinkedBlock(java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recoverTempUnlinkedBlock</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.332">recoverTempUnlinkedBlock</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;unlinkedTmp)
                        throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Recover an unlinked tmp file on datanode restart. If the original block
 does not exist, then the tmp file is renamed to be the
 original file name and the original name is returned; otherwise the tmp
 file is deleted and null is returned.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="moveLazyPersistReplicasToFinalized(java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>moveLazyPersistReplicasToFinalized</h4>
<pre>private&nbsp;int&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.356">moveLazyPersistReplicasToFinalized</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;source)
                                        throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Move replicas in the lazy persist directory to their corresponding locations
 in the finalized directory.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>number of replicas recovered.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="addToReplicasMap(org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.ReplicaMap, java.io.File, org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.RamDiskReplicaTracker, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addToReplicasMap</h4>
<pre>void&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.420">addToReplicasMap</a>(<a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/ReplicaMap.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">ReplicaMap</a>&nbsp;volumeMap,
                    <a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;dir,
                    <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/RamDiskReplicaTracker.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">RamDiskReplicaTracker</a>&nbsp;lazyWriteReplicaMap,
                    boolean&nbsp;isFinalized)
                throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Add replicas under the given directory to the volume map</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>volumeMap</code> - the replicas map</dd><dd><code>dir</code> - an input directory</dd><dd><code>lazyWriteReplicaMap</code> - Map of replicas on transient
                                storage.</dd><dd><code>isFinalized</code> - true if the directory has finalized replicas;
                    false if the directory has rbw replicas</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="resolveDuplicateReplicas(org.apache.hadoop.hdfs.server.datanode.ReplicaInfo, org.apache.hadoop.hdfs.server.datanode.ReplicaInfo, org.apache.hadoop.hdfs.server.datanode.fsdataset.impl.ReplicaMap)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resolveDuplicateReplicas</h4>
<pre><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaInfo.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaInfo</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.528">resolveDuplicateReplicas</a>(<a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaInfo.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaInfo</a>&nbsp;replica1,
                                   <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/ReplicaInfo.html" title="class in org.apache.hadoop.hdfs.server.datanode">ReplicaInfo</a>&nbsp;replica2,
                                   <a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/ReplicaMap.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl">ReplicaMap</a>&nbsp;volumeMap)
                               throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method is invoked during DN startup when volumes are scanned to
 build up the volumeMap.

 Given two replicas, decide which one to keep. The preference is as
 follows:
   1. Prefer the replica with the higher generation stamp.
   2. If generation stamps are equal, prefer the replica with the
      larger on-disk length.
   3. If on-disk length is the same, prefer the replica on persistent
      storage volume.
   4. All other factors being equal, keep replica1.

 The other replica is removed from the volumeMap and is deleted from
 its storage volume.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>replica1</code> - </dd><dd><code>replica2</code> - </dd><dd><code>volumeMap</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>the replica that is retained.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="validateIntegrityAndSetLength(java.io.File, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>validateIntegrityAndSetLength</h4>
<pre>private&nbsp;long&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.587">validateIntegrityAndSetLength</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;blockFile,
                                 long&nbsp;genStamp)</pre>
<div class="block">Find out the number of bytes in the block that match its crc.
 
 This algorithm assumes that data corruption caused by unexpected 
 datanode shutdown occurs only in the last crc chunk. So it checks
 only the last chunk.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>blockFile</code> - the block file</dd><dd><code>genStamp</code> - generation stamp of the block</dd>
<dt><span class="strong">Returns:</span></dt><dd>the number of valid bytes</dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.654">toString</a>()</pre>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
</dl>
</li>
</ul>
<a name="shutdown()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>shutdown</h4>
<pre>void&nbsp;<a href="../../../../../../../../src-html/org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html#line.658">shutdown</a>()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockPoolSlice.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../../../../org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/FsDatasetAsyncDiskService.html" title="class in org.apache.hadoop.hdfs.server.datanode.fsdataset.impl"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../../index.html?org/apache/hadoop/hdfs/server/datanode/fsdataset/impl/BlockPoolSlice.html" target="_top">Frames</a></li>
<li><a href="BlockPoolSlice.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
