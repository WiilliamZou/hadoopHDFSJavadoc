<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_80) on Wed Jun 10 23:53:41 EDT 2015 -->
<title>BlockTokenSecretManager</title>
<meta name="date" content="2015-06-10">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="BlockTokenSecretManager";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockTokenSecretManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.Renewer.html" title="class in org.apache.hadoop.hdfs.security.token.block"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html" target="_top">Frames</a></li>
<li><a href="BlockTokenSecretManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.hadoop.hdfs.security.token.block</div>
<h2 title="Class BlockTokenSecretManager" class="title">Class BlockTokenSecretManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.hadoop.security.token.SecretManager&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;</li>
<li>
<ul class="inheritance">
<li>org.apache.hadoop.hdfs.security.token.block.BlockTokenSecretManager</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>@InterfaceAudience.Private
public class <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.53">BlockTokenSecretManager</a>
extends org.apache.hadoop.security.token.SecretManager&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;</pre>
<div class="block">BlockTokenSecretManager can be instantiated in 2 modes, master mode and slave
 mode. Master can generate new block keys and export block keys to slaves,
 while slaves can only import and use block keys received from master. Both
 master and slave can generate and verify block tokens. Typically, master mode
 is used by NN and slave mode is used by DN.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a></strong></code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="nested_classes_inherited_from_class_org.apache.hadoop.security.token.SecretManager">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from class&nbsp;org.apache.hadoop.security.token.SecretManager</h3>
<code>org.apache.hadoop.security.token.SecretManager.InvalidToken</code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>,<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockKey.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockKey</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#allKeys">allKeys</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#blockPoolId">blockPoolId</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockKey.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockKey</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#currentKey">currentKey</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#DUMMY_TOKEN">DUMMY_TOKEN</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#encryptionAlgorithm">encryptionAlgorithm</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#isMaster">isMaster</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#keyUpdateInterval">keyUpdateInterval</a></strong></code>
<div class="block">keyUpdateInterval is the interval that NN updates its block keys.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static org.apache.commons.logging.Log</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#LOG">LOG</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#LOW_MASK">LOW_MASK</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockKey.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockKey</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#nextKey">nextKey</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#nnIndex">nnIndex</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="https://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html?is-external=true" title="class or interface in java.security">SecureRandom</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#nonceGenerator">nonceGenerator</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#serialNo">serialNo</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#tokenLifetime">tokenLifetime</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private </code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#BlockTokenSecretManager(boolean,%20long,%20long,%20java.lang.String,%20java.lang.String)">BlockTokenSecretManager</a></strong>(boolean&nbsp;isMaster,
                                              long&nbsp;keyUpdateInterval,
                                              long&nbsp;tokenLifetime,
                                              <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;blockPoolId,
                                              <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;encryptionAlgorithm)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#BlockTokenSecretManager(long,%20long,%20int,%20java.lang.String,%20java.lang.String)">BlockTokenSecretManager</a></strong>(long&nbsp;keyUpdateInterval,
                                              long&nbsp;tokenLifetime,
                                              int&nbsp;nnIndex,
                                              <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;blockPoolId,
                                              <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;encryptionAlgorithm)</code>
<div class="block">Constructor for masters.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#BlockTokenSecretManager(long,%20long,%20java.lang.String,%20java.lang.String)">BlockTokenSecretManager</a></strong>(long&nbsp;keyUpdateInterval,
                                              long&nbsp;tokenLifetime,
                                              <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;blockPoolId,
                                              <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;encryptionAlgorithm)</code>
<div class="block">Constructor for slaves.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#addKeys(org.apache.hadoop.hdfs.security.token.block.ExportedBlockKeys)">addKeys</a></strong>(<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/ExportedBlockKeys.html" title="class in org.apache.hadoop.hdfs.security.token.block">ExportedBlockKeys</a>&nbsp;exportedKeys)</code>
<div class="block">Set block keys, only to be used in slave mode</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#checkAccess(org.apache.hadoop.hdfs.security.token.block.BlockTokenIdentifier,%20java.lang.String,%20org.apache.hadoop.hdfs.protocol.ExtendedBlock,%20org.apache.hadoop.hdfs.security.token.block.BlockTokenSecretManager.AccessMode)">checkAccess</a></strong>(<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&nbsp;id,
                      <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;userId,
                      <a href="../../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                      <a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a>&nbsp;mode)</code>
<div class="block">Check if access should be allowed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#checkAccess(org.apache.hadoop.security.token.Token,%20java.lang.String,%20org.apache.hadoop.hdfs.protocol.ExtendedBlock,%20org.apache.hadoop.hdfs.security.token.block.BlockTokenSecretManager.AccessMode)">checkAccess</a></strong>(org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;&nbsp;token,
                      <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;userId,
                      <a href="../../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                      <a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a>&nbsp;mode)</code>
<div class="block">Check if access should be allowed.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#clearAllKeysForTesting()">clearAllKeysForTesting</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#createIdentifier()">createIdentifier</a></strong>()</code>
<div class="block">Create an empty block token identifier</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#createPassword(org.apache.hadoop.hdfs.security.token.block.BlockTokenIdentifier)">createPassword</a></strong>(<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&nbsp;identifier)</code>
<div class="block">Create a new password/secret for the given block token identifier.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/ExportedBlockKeys.html" title="class in org.apache.hadoop.hdfs.security.token.block">ExportedBlockKeys</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#exportKeys()">exportKeys</a></strong>()</code>
<div class="block">Export block keys, only to be used in master mode</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/DataEncryptionKey.html" title="class in org.apache.hadoop.hdfs.security.token.block">DataEncryptionKey</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#generateDataEncryptionKey()">generateDataEncryptionKey</a></strong>()</code>
<div class="block">Generate a data encryption key for this block pool, using the current
 BlockKey.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#generateKeys()">generateKeys</a></strong>()</code>
<div class="block">Initialize block keys</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#generateToken(org.apache.hadoop.hdfs.protocol.ExtendedBlock,%20java.util.EnumSet)">generateToken</a></strong>(<a href="../../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                          <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumSet.html?is-external=true" title="class or interface in java.util">EnumSet</a>&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a>&gt;&nbsp;modes)</code>
<div class="block">Generate an block token for current user</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#generateToken(java.lang.String,%20org.apache.hadoop.hdfs.protocol.ExtendedBlock,%20java.util.EnumSet)">generateToken</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;userId,
                          <a href="../../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                          <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumSet.html?is-external=true" title="class or interface in java.util">EnumSet</a>&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a>&gt;&nbsp;modes)</code>
<div class="block">Generate a block token for a specified user</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#getSerialNoForTesting()">getSerialNoForTesting</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#isExpired(long)">isExpired</a></strong>(long&nbsp;expiryDate)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#isTokenExpired(org.apache.hadoop.security.token.Token)">isTokenExpired</a></strong>(org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;&nbsp;token)</code>
<div class="block">check if a token is expired.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#removeExpiredKeys()">removeExpiredKeys</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#retrieveDataEncryptionKey(int,%20byte[])">retrieveDataEncryptionKey</a></strong>(int&nbsp;keyId,
                                                  byte[]&nbsp;nonce)</code>
<div class="block">Recreate an encryption key based on the given key id and nonce.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#retrievePassword(org.apache.hadoop.hdfs.security.token.block.BlockTokenIdentifier)">retrievePassword</a></strong>(<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&nbsp;identifier)</code>
<div class="block">Look up the token password/secret for the given block token identifier.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#setBlockPoolId(java.lang.String)">setBlockPoolId</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;blockPoolId)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#setKeyUpdateIntervalForTesting(long)">setKeyUpdateIntervalForTesting</a></strong>(long&nbsp;millis)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#setSerialNo(int)">setSerialNo</a></strong>(int&nbsp;serialNo)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#setTokenLifetime(long)">setTokenLifetime</a></strong>(long&nbsp;tokenLifetime)</code>
<div class="block">set token lifetime.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#updateKeys()">updateKeys</a></strong>()</code>
<div class="block">Update block keys, only to be used in master mode</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#updateKeys(long)">updateKeys</a></strong>(long&nbsp;updateTime)</code>
<div class="block">Update block keys if update time > update interval.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.apache.hadoop.security.token.SecretManager">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.apache.hadoop.security.token.SecretManager</h3>
<code>checkAvailableForRead, createPassword, createSecretKey, generateSecret, retriableRetrievePassword</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long,%20int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="LOG">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOG</h4>
<pre>public static final&nbsp;org.apache.commons.logging.Log <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.55">LOG</a></pre>
</li>
</ul>
<a name="LOW_MASK">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>LOW_MASK</h4>
<pre>private static final&nbsp;int <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.60">LOW_MASK</a></pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../../constant-values.html#org.apache.hadoop.hdfs.security.token.block.BlockTokenSecretManager.LOW_MASK">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="DUMMY_TOKEN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DUMMY_TOKEN</h4>
<pre>public static final&nbsp;org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt; <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.62">DUMMY_TOKEN</a></pre>
</li>
</ul>
<a name="isMaster">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isMaster</h4>
<pre>private final&nbsp;boolean <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.64">isMaster</a></pre>
</li>
</ul>
<a name="nnIndex">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nnIndex</h4>
<pre>private&nbsp;int <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.65">nnIndex</a></pre>
</li>
</ul>
<a name="keyUpdateInterval">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>keyUpdateInterval</h4>
<pre>private&nbsp;long <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.72">keyUpdateInterval</a></pre>
<div class="block">keyUpdateInterval is the interval that NN updates its block keys. It should
 be set long enough so that all live DN's and Balancer should have sync'ed
 their block keys with NN at least once during each interval.</div>
</li>
</ul>
<a name="tokenLifetime">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tokenLifetime</h4>
<pre>private volatile&nbsp;long <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.73">tokenLifetime</a></pre>
</li>
</ul>
<a name="serialNo">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serialNo</h4>
<pre>private&nbsp;int <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.74">serialNo</a></pre>
</li>
</ul>
<a name="currentKey">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>currentKey</h4>
<pre>private&nbsp;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockKey.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockKey</a> <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.75">currentKey</a></pre>
</li>
</ul>
<a name="nextKey">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nextKey</h4>
<pre>private&nbsp;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockKey.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockKey</a> <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.76">nextKey</a></pre>
</li>
</ul>
<a name="allKeys">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>allKeys</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>,<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockKey.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockKey</a>&gt; <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.77">allKeys</a></pre>
</li>
</ul>
<a name="blockPoolId">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>blockPoolId</h4>
<pre>private&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.78">blockPoolId</a></pre>
</li>
</ul>
<a name="encryptionAlgorithm">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encryptionAlgorithm</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.79">encryptionAlgorithm</a></pre>
</li>
</ul>
<a name="nonceGenerator">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>nonceGenerator</h4>
<pre>private final&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html?is-external=true" title="class or interface in java.security">SecureRandom</a> <a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.81">nonceGenerator</a></pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BlockTokenSecretManager(long, long, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BlockTokenSecretManager</h4>
<pre>public&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.93">BlockTokenSecretManager</a>(long&nbsp;keyUpdateInterval,
                       long&nbsp;tokenLifetime,
                       <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;blockPoolId,
                       <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;encryptionAlgorithm)</pre>
<div class="block">Constructor for slaves.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>keyUpdateInterval</code> - how often a new key will be generated</dd><dd><code>tokenLifetime</code> - how long an individual token is valid</dd></dl>
</li>
</ul>
<a name="BlockTokenSecretManager(long, long, int, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BlockTokenSecretManager</h4>
<pre>public&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.108">BlockTokenSecretManager</a>(long&nbsp;keyUpdateInterval,
                       long&nbsp;tokenLifetime,
                       int&nbsp;nnIndex,
                       <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;blockPoolId,
                       <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;encryptionAlgorithm)</pre>
<div class="block">Constructor for masters.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>keyUpdateInterval</code> - how often a new key will be generated</dd><dd><code>tokenLifetime</code> - how long an individual token is valid</dd><dd><code>nnIndex</code> - namenode index</dd><dd><code>blockPoolId</code> - block pool ID</dd><dd><code>encryptionAlgorithm</code> - encryption algorithm to use</dd></dl>
</li>
</ul>
<a name="BlockTokenSecretManager(boolean, long, long, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BlockTokenSecretManager</h4>
<pre>private&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.119">BlockTokenSecretManager</a>(boolean&nbsp;isMaster,
                       long&nbsp;keyUpdateInterval,
                       long&nbsp;tokenLifetime,
                       <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;blockPoolId,
                       <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;encryptionAlgorithm)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setSerialNo(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setSerialNo</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.131">setSerialNo</a>(int&nbsp;serialNo)</pre>
</li>
</ul>
<a name="setBlockPoolId(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setBlockPoolId</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.135">setBlockPoolId</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;blockPoolId)</pre>
</li>
</ul>
<a name="generateKeys()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateKeys</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.140">generateKeys</a>()</pre>
<div class="block">Initialize block keys</div>
</li>
</ul>
<a name="exportKeys()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>exportKeys</h4>
<pre>public&nbsp;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/ExportedBlockKeys.html" title="class in org.apache.hadoop.hdfs.security.token.block">ExportedBlockKeys</a>&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.166">exportKeys</a>()</pre>
<div class="block">Export block keys, only to be used in master mode</div>
</li>
</ul>
<a name="removeExpiredKeys()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeExpiredKeys</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.175">removeExpiredKeys</a>()</pre>
</li>
</ul>
<a name="addKeys(org.apache.hadoop.hdfs.security.token.block.ExportedBlockKeys)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addKeys</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.189">addKeys</a>(<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/ExportedBlockKeys.html" title="class in org.apache.hadoop.hdfs.security.token.block">ExportedBlockKeys</a>&nbsp;exportedKeys)
             throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Set block keys, only to be used in slave mode</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="updateKeys(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateKeys</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.208">updateKeys</a>(long&nbsp;updateTime)
                   throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Update block keys if update time > update interval.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true if the keys are updated.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="updateKeys()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateKeys</h4>
<pre>boolean&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.218">updateKeys</a>()
             throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Update block keys, only to be used in master mode</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="generateToken(org.apache.hadoop.hdfs.protocol.ExtendedBlock, java.util.EnumSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateToken</h4>
<pre>public&nbsp;org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.241">generateToken</a>(<a href="../../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                                                                         <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumSet.html?is-external=true" title="class or interface in java.util">EnumSet</a>&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a>&gt;&nbsp;modes)
                                                                           throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Generate an block token for current user</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="generateToken(java.lang.String, org.apache.hadoop.hdfs.protocol.ExtendedBlock, java.util.EnumSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateToken</h4>
<pre>public&nbsp;org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.249">generateToken</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;userId,
                                                                         <a href="../../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
                                                                         <a href="https://docs.oracle.com/javase/7/docs/api/java/util/EnumSet.html?is-external=true" title="class or interface in java.util">EnumSet</a>&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a>&gt;&nbsp;modes)
                                                                           throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Generate a block token for a specified user</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="checkAccess(org.apache.hadoop.hdfs.security.token.block.BlockTokenIdentifier, java.lang.String, org.apache.hadoop.hdfs.protocol.ExtendedBlock, org.apache.hadoop.hdfs.security.token.block.BlockTokenSecretManager.AccessMode)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkAccess</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.261">checkAccess</a>(<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&nbsp;id,
               <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;userId,
               <a href="../../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
               <a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a>&nbsp;mode)
                 throws org.apache.hadoop.security.token.SecretManager.InvalidToken</pre>
<div class="block">Check if access should be allowed. userID is not checked if null. This
 method doesn't check if token password is correct. It should be used only
 when token password has already been verified (e.g., in the RPC layer).</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>org.apache.hadoop.security.token.SecretManager.InvalidToken</code></dd></dl>
</li>
</ul>
<a name="checkAccess(org.apache.hadoop.security.token.Token, java.lang.String, org.apache.hadoop.hdfs.protocol.ExtendedBlock, org.apache.hadoop.hdfs.security.token.block.BlockTokenSecretManager.AccessMode)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkAccess</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.290">checkAccess</a>(org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;&nbsp;token,
               <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;userId,
               <a href="../../../../../../../org/apache/hadoop/hdfs/protocol/ExtendedBlock.html" title="class in org.apache.hadoop.hdfs.protocol">ExtendedBlock</a>&nbsp;block,
               <a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block">BlockTokenSecretManager.AccessMode</a>&nbsp;mode)
                 throws org.apache.hadoop.security.token.SecretManager.InvalidToken</pre>
<div class="block">Check if access should be allowed. userID is not checked if null</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>org.apache.hadoop.security.token.SecretManager.InvalidToken</code></dd></dl>
</li>
</ul>
<a name="isExpired(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isExpired</h4>
<pre>private static&nbsp;boolean&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.308">isExpired</a>(long&nbsp;expiryDate)</pre>
</li>
</ul>
<a name="isTokenExpired(org.apache.hadoop.security.token.Token)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isTokenExpired</h4>
<pre>static&nbsp;boolean&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.316">isTokenExpired</a>(org.apache.hadoop.security.token.Token&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;&nbsp;token)
                       throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">check if a token is expired. for unit test only. return true when token is
 expired, false otherwise</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="setTokenLifetime(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setTokenLifetime</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.325">setTokenLifetime</a>(long&nbsp;tokenLifetime)</pre>
<div class="block">set token lifetime.</div>
</li>
</ul>
<a name="createIdentifier()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createIdentifier</h4>
<pre>public&nbsp;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.335">createIdentifier</a>()</pre>
<div class="block">Create an empty block token identifier</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>createIdentifier</code>&nbsp;in class&nbsp;<code>org.apache.hadoop.security.token.SecretManager&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>a newly created empty block token identifier</dd></dl>
</li>
</ul>
<a name="createPassword(org.apache.hadoop.hdfs.security.token.block.BlockTokenIdentifier)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createPassword</h4>
<pre>protected&nbsp;byte[]&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.347">createPassword</a>(<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&nbsp;identifier)</pre>
<div class="block">Create a new password/secret for the given block token identifier.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>createPassword</code>&nbsp;in class&nbsp;<code>org.apache.hadoop.security.token.SecretManager&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>identifier</code> - the block token identifier</dd>
<dt><span class="strong">Returns:</span></dt><dd>token password/secret</dd></dl>
</li>
</ul>
<a name="retrievePassword(org.apache.hadoop.hdfs.security.token.block.BlockTokenIdentifier)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>retrievePassword</h4>
<pre>public&nbsp;byte[]&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.371">retrievePassword</a>(<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&nbsp;identifier)
                        throws org.apache.hadoop.security.token.SecretManager.InvalidToken</pre>
<div class="block">Look up the token password/secret for the given block token identifier.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>retrievePassword</code>&nbsp;in class&nbsp;<code>org.apache.hadoop.security.token.SecretManager&lt;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.html" title="class in org.apache.hadoop.hdfs.security.token.block">BlockTokenIdentifier</a>&gt;</code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>identifier</code> - the block token identifier to look up</dd>
<dt><span class="strong">Returns:</span></dt><dd>token password/secret as byte[]</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>InvalidToken</code></dd>
<dd><code>org.apache.hadoop.security.token.SecretManager.InvalidToken</code></dd></dl>
</li>
</ul>
<a name="generateDataEncryptionKey()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateDataEncryptionKey</h4>
<pre>public&nbsp;<a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/DataEncryptionKey.html" title="class in org.apache.hadoop.hdfs.security.token.block">DataEncryptionKey</a>&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.396">generateDataEncryptionKey</a>()</pre>
<div class="block">Generate a data encryption key for this block pool, using the current
 BlockKey.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>a data encryption key which may be used to encrypt traffic
         over the DataTransferProtocol</dd></dl>
</li>
</ul>
<a name="retrieveDataEncryptionKey(int, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>retrieveDataEncryptionKey</h4>
<pre>public&nbsp;byte[]&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.417">retrieveDataEncryptionKey</a>(int&nbsp;keyId,
                               byte[]&nbsp;nonce)
                                 throws <a href="../../../../../../../org/apache/hadoop/hdfs/protocol/datatransfer/InvalidEncryptionKeyException.html" title="class in org.apache.hadoop.hdfs.protocol.datatransfer">InvalidEncryptionKeyException</a></pre>
<div class="block">Recreate an encryption key based on the given key id and nonce.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>keyId</code> - identifier of the secret key used to generate the encryption key.</dd><dd><code>nonce</code> - random value used to create the encryption key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the encryption key which corresponds to this (keyId, blockPoolId, nonce)</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../../../org/apache/hadoop/hdfs/protocol/datatransfer/InvalidEncryptionKeyException.html" title="class in org.apache.hadoop.hdfs.protocol.datatransfer">InvalidEncryptionKeyException</a></code></dd></dl>
</li>
</ul>
<a name="setKeyUpdateIntervalForTesting(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setKeyUpdateIntervalForTesting</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.432">setKeyUpdateIntervalForTesting</a>(long&nbsp;millis)</pre>
</li>
</ul>
<a name="clearAllKeysForTesting()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clearAllKeysForTesting</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.437">clearAllKeysForTesting</a>()</pre>
</li>
</ul>
<a name="getSerialNoForTesting()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getSerialNoForTesting</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../../../../src-html/org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html#line.442">getSerialNoForTesting</a>()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BlockTokenSecretManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenIdentifier.Renewer.html" title="class in org.apache.hadoop.hdfs.security.token.block"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../../org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.AccessMode.html" title="enum in org.apache.hadoop.hdfs.security.token.block"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?org/apache/hadoop/hdfs/security/token/block/BlockTokenSecretManager.html" target="_top">Frames</a></li>
<li><a href="BlockTokenSecretManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
